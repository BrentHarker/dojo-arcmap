//>>built
define(["require","exports","./EventMatch","../../core/Logger"],function(d,h,l,m){Object.defineProperty(h,"__esModule",{value:!0});var k=m.getLogger("esri.views.input");d=function(){function b(a,c){this._manager=null;this._incoming={};this._outgoing={};this._outgoingEventTypes=this._incomingEventTypes=this._incomingEventMatches=null;this._name=a;this._hasSideEffects=c}return Object.defineProperty(b.prototype,"incomingEventMatches",{get:function(){if(!this._incomingEventMatches){this._incomingEventMatches=
[];for(var a in this._incoming)for(var c=0,b=this._incoming[a];c<b.length;c++)this._incomingEventMatches.push(b[c].match)}return this._incomingEventMatches},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"incomingEventTypes",{get:function(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(function(a){return a.eventType})),this._incomingEventTypes},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"outgoingEventTypes",{get:function(){return this._outgoingEventTypes||
(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"hasSideEffects",{get:function(){return this._hasSideEffects},enumerable:!0,configurable:!0}),b.prototype.onInstall=function(a){var c=this;return this._manager?void k.error("This InputHandler has already been registered with an InputManager"):(a.setEventCallback(function(a){return c._handleEvent(a)}),a.setUninstallCallback(function(){return c._onUninstall()}),
void(this._manager=a))},b.prototype.onUninstall=function(){},b.prototype.registerIncoming=function(a,c,b){var f,e=this;"function"==typeof c?(b=c,f=[]):f=c||[];a="string"==typeof a?new l.EventMatch(a,f):a;var g=function(){e._incomingEventTypes=null;e._incomingEventMatches=null};c=function(a){var c=e._incoming[a.match.eventType];c&&(a=c.indexOf(a),c.splice(a,1),g(),e._manager&&e._manager.updateDependencies())};b=new n(a,b,{onPause:c,onRemove:c,onResume:function(a){var c=e._incoming[a.match.eventType];
c&&-1===c.indexOf(a)&&(c.push(a),g(),e._manager&&e._manager.updateDependencies())}});c=this._incoming[a.eventType];return c||(c=[],this._incoming[a.eventType]=c),c.push(b),g(),this._manager&&this._manager.updateDependencies(),b},b.prototype.registerOutgoing=function(a){var c=this;if(this._outgoing[a])throw Error("There is already a callback registered for this outgoing InputEvent: "+a);var b=new p(a,{onEmit:function(a,b,f,d){c._manager.emit(a.eventType,b,f,d)},onRemove:function(a){delete c._outgoing[a.eventType];
c._manager.updateDependencies()}});return this._outgoing[a]=b,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),b},b.prototype.startCapturingPointer=function(a){this._manager.setPointerCapture(a,!0)},b.prototype.stopCapturingPointer=function(a){this._manager.setPointerCapture(a,!1)},b.prototype._onUninstall=function(){return this._manager?(this.onUninstall(),void(this._manager=null)):void k.error("This InputHandler is not registered with an InputManager")},b.prototype._handleEvent=
function(a){var c=this._incoming[a.type];if(c)for(var b=0;b<c.length;b++){var d=c[b];if(d.match.matches(a)&&(d.callback(a),a.shouldStopPropagation()))break}},b}();h.InputHandler=d;var n=function(){function b(a,c,b){this.match=a;this._callback=c;this._handler=b}return b.prototype.pause=function(){this._handler.onPause(this)},b.prototype.resume=function(){this._handler.onResume(this)},b.prototype.remove=function(){this._handler.onRemove(this)},Object.defineProperty(b.prototype,"callback",{get:function(){return this._callback},
enumerable:!0,configurable:!0}),b}(),p=function(){function b(a,b){this.eventType=a;this._removed=!1;this._handler=b}return b.prototype.emit=function(a,b,d){this._removed||this._handler.onEmit(this,a,b,d)},b.prototype.remove=function(){this._removed=!0;this._handler.onRemove(this)},b}()});