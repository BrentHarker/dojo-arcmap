//>>built
define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor".split(" "),function(e,t,q,p,f,r){e=function(e){function b(a){a=e.call(this,a)||this;return a._container=null,a._overlay=null,a._backgroundShape=null,a._boxShape=null,a._box={x:0,y:0,width:0,height:0},a._redraw=a._redraw.bind(a),a}return q(b,e),b.prototype.destroy=function(){this.view=null},Object.defineProperty(b.prototype,"view",
{set:function(a){var d=this;this._handles&&this._handles.forEach(function(a){a.remove()});this._handles=null;this._destroyOverlay();this._set("view",a);a&&(a.on("drag",["Shift"],function(a){return d._handleDrag(a,1)}),a.on("drag",["Shift","Ctrl"],function(a){return d._handleDrag(a,-1)}))},enumerable:!0,configurable:!0}),b.prototype._start=function(a,d,c,g){this._createContainer();this._createOverlay();this.navigation.begin()},b.prototype._update=function(a,d,c,g){this._box.x=a;this._box.y=d;this._box.width=
c;this._box.height=g;this._rafId||(this._rafId=requestAnimationFrame(this._redraw))},b.prototype._end=function(a,d,c,g,k){var b=this.view;a=b.toMap(a+.5*c,d+.5*g);c=Math.min(c/b.width,g/b.height);-1===k&&(c=1/c);this._destroyOverlay();this.navigation.end();b.goTo({center:a,scale:b.scale*c})},b.prototype._updateBox=function(a,d,c,g){var b=this._boxShape;b.setAttributeNS(null,"x",""+a);b.setAttributeNS(null,"y",""+d);b.setAttributeNS(null,"width",""+c);b.setAttributeNS(null,"height",""+g);b.setAttributeNS(null,
"class","esri-zoom-box__outline")},b.prototype._updateBackground=function(a,d,c,b){this._backgroundShape.setAttributeNS(null,"d",this._toSVGPath(a,d,c,b,this.view.width,this.view.height))},b.prototype._createContainer=function(){var a=document.createElement("div");a.className="esri-zoom-box__container";this.view.root.appendChild(a);this._container=a},b.prototype._createOverlay=function(){var a=this.view.width,d=this.view.height,c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttributeNS(null,
"d","M 0 0 L "+a+" 0 L "+a+" "+d+" L 0 "+d+" Z");c.setAttributeNS(null,"class","esri-zoom-box__overlay-background");a=document.createElementNS("http://www.w3.org/2000/svg","rect");d=document.createElementNS("http://www.w3.org/2000/svg","svg");d.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");d.setAttributeNS(null,"class","esri-zoom-box__overlay");d.appendChild(c);d.appendChild(a);this._container.appendChild(d);this._backgroundShape=c;this._boxShape=a;this._overlay=
d},b.prototype._destroyOverlay=function(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container);this._container=this._backgroundShape=this._boxShape=this._overlay=null},b.prototype._toSVGPath=function(a,d,c,b,k,e){c=a+c;b=d+b;return"M 0 0 L "+k+" 0 L "+k+" "+e+" L 0 "+e+" ZM "+a+" "+d+" L "+a+" "+b+" L "+c+" "+b+" L "+c+" "+d+" Z"},b.prototype._handleDrag=function(a,b){var c,d,e,h,f=a.x,l=a.y,m=a.origin.x,n=a.origin.y;switch(f>m?(c=m,e=f-m):(c=f,e=m-
f),l>n?(d=n,h=l-n):(d=l,h=n-l),a.action){case "start":this._start(c,d,e,h);break;case "update":this._update(c,d,e,h);break;case "end":this._end(c,d,e,h,b)}a.stopPropagation()},b.prototype._redraw=function(){if(this._rafId&&(this._rafId=null,this._overlay)){var a=this._box,b=a.x,c=a.y,e=a.width,a=a.height;this._updateBox(b,c,e,a);this._updateBackground(b,c,e,a);this._rafId=requestAnimationFrame(this._redraw)}},b}(f.declared(r));return p([f.property()],e.prototype,"navigation",void 0),p([f.property()],
e.prototype,"view",null),e=p([f.subclass("esri.views.2d.navigation.ZoomBox")],e)});