//>>built
require({cache:{"esri/views/vectorTiles/WorkerTile":function(){define("require exports dojo/Deferred ../../core/promiseUtils ../../core/executeAsync ../../core/ObjectPool ./VertexMemoryBuffer ./IndexMemoryBuffer ./TileParser ./BackgroundBucket ./FillBucket ./LineBucket ./SymbolBucket ./Placement ./GeometryUtils".split(" "),function(z,a,d,E,x,q,m,b,c,h,f,k,l,A,y){z=function(){function a(){this.status=this.rotation=0;this._symbolBuckets=[];this.placementEngine=new A.PlacementEngine;this.polygonVertexBuffer=
new m.PolygonMemoryBuffer;this.polygonOutlineVertexBuffer=new m.PolygonOutlineMemoryBuffer;this.polygonIndexBuffer=new b.TriangleElementMemoryBuffer;this.polygonOutlineIndexBuffer=new b.TriangleElementMemoryBuffer;this.lineVertexBuffer=new m.LineMemoryBuffer;this.lineIndexBuffer=new b.TriangleElementMemoryBuffer;this.markerVertexBuffer=new m.SymbolMemoryBuffer;this.markerIndexBuffer=new b.TriangleElementMemoryBuffer;this.textVertexBuffer=new m.SymbolMemoryBuffer;this.textIndexBuffer=new b.TriangleElementMemoryBuffer}
return a.prototype.initialize=function(a,b,c,f){void 0===f&&(f=0);this.tileKey=a;this.refKey=b;this._workerTileHandler=c;this.rotation=f;this.placementEngine.setAngle(y.C_DEG_TO_RAD*f)},a.prototype.release=function(){this.tileKey=this.refKey="";this.rotation=this.status=0;this.polygonVertexBuffer.reset();this.polygonOutlineVertexBuffer.reset();this.polygonIndexBuffer.reset();this.polygonOutlineIndexBuffer.reset();this.lineVertexBuffer.reset();this.lineIndexBuffer.reset();this.markerVertexBuffer.reset();
this.markerIndexBuffer.reset();this.textVertexBuffer.reset();this.textIndexBuffer.reset();this.placementEngine.reset();this._symbolBuckets.length=0;this._workerTileHandler=null},a.prototype.setDataAndParse=function(a,b){var c=this,A=new d(function(a){c.status=6});return this._parse(a,b).then(function(a){c.status=4;for(var b=new Uint32Array([2,c.polygonVertexBuffer.sizeInBytes,3,c.polygonOutlineVertexBuffer.sizeInBytes,6,c.polygonIndexBuffer.sizeInBytes,7,c.polygonOutlineIndexBuffer.sizeInBytes,0,
c.lineVertexBuffer.sizeInBytes,8,c.lineIndexBuffer.sizeInBytes,4,c.markerVertexBuffer.sizeInBytes,9,c.markerIndexBuffer.sizeInBytes,5,c.textVertexBuffer.sizeInBytes,10,c.textIndexBuffer.sizeInBytes]),n=[],p=a.length,d=0;p>d;d++){var r=a[d];if(r instanceof f)n.push(r.layerIndex),n.push(1),n.push(r.polygonIndexStart),n.push(r.polygonIndexCount),n.push(r.polygonOutlineIndexStart),n.push(r.polygonOutlineIndexCount);else if(r instanceof k)n.push(r.layerIndex),n.push(2),n.push(r.triangleIndexStart),n.push(r.triangleIndexCount),
n.push(r.connectorStart),n.push(r.connectorCount);else if(r instanceof l){n.push(r.layerIndex);n.push(3);n.push(r.sdfMarker?1:0);var y=r.markerPageMap;n.push(y.size);y.forEach(function(a,b){n.push(b);n.push(a[0]);n.push(a[1])});r=r.glyphsPageMap;n.push(r.size);r.forEach(function(a,b){n.push(b);n.push(a[0]);n.push(a[1])})}else r instanceof h&&(n.push(r.layerIndex),n.push(0))}a=new Uint32Array(n);var p=c.polygonVertexBuffer.toBuffer(),d=c.polygonOutlineVertexBuffer.toBuffer(),r=c.polygonIndexBuffer.toBuffer(),
y=c.polygonOutlineIndexBuffer.toBuffer(),C=c.lineVertexBuffer.toBuffer(),B=c.lineIndexBuffer.toBuffer(),v=c.markerVertexBuffer.toBuffer(),F=c.markerIndexBuffer.toBuffer(),t=c.textVertexBuffer.toBuffer(),J=c.textIndexBuffer.toBuffer();A.resolve({data:{bufferDataInfo:b.buffer,bucketDataInfo:a.buffer,bufferData:[p,d,r,y,C,B,v,F,t,J]},buffers:[p,r,d,y,C,B,v,F,t,J,b.buffer,a.buffer]})}),A.promise},a.prototype.addBucket=function(a){this._symbolBuckets.push(a)},a.prototype.updateSymbols=function(a){var b=
this,c=this._symbolBuckets;if(!c||0===c.length)return E.resolve({data:null});this.rotation=a;var f=this.placementEngine;f.reset();f.setAngle(a/256*360*y.C_DEG_TO_RAD);var h=this.markerVertexBuffer;h.reset();var k=this.markerIndexBuffer;k.reset();var n=this.textVertexBuffer;n.reset();var l=this.textIndexBuffer;l.reset();var r=[],A=c.length,p=0;return x(function(){if(6===b.status||0===b.status)return!0;if(A>p){var a=c[p++].copy(h,k,n,l,f);a&&(r.push(a),a.updateSymbols())}return p>=A},5).then(function(){if(6===
b.status||0===b.status||0===h.sizeInBytes&&0===k.sizeInBytes&&0===n.sizeInBytes&&0===l.sizeInBytes)return{data:null};var a=new Uint32Array([4,h.sizeInBytes,9,k.sizeInBytes,5,n.sizeInBytes,10,l.sizeInBytes]),c=[];A=r.length;for(var f=0;A>f;f++){var w=r[f];c.push(w.layerIndex);c.push(3);c.push(w.sdfMarker?1:0);var t=w.markerPageMap;c.push(t.size);t.forEach(function(a,b){c.push(b);c.push(a[0]);c.push(a[1])});w=w.glyphsPageMap;c.push(w.size);w.forEach(function(a,b){c.push(b);c.push(a[0]);c.push(a[1])})}var f=
new Uint32Array(c),w=h.toBuffer(),t=k.toBuffer(),p=n.toBuffer(),d=l.toBuffer();return{data:{bufferDataInfo:a.buffer,bucketDataInfo:f.buffer,bufferData:[w,t,p,d]},buffers:[w,t,p,d,a.buffer,f.buffer]}}).otherwise(function(a){return E.resolve({data:null})})},a.prototype.setObsolete=function(){this.status=6},a.prototype.getLayers=function(){return this._workerTileHandler.getLayers()},a.prototype.getWorkerTileHandler=function(){return this._workerTileHandler},a.prototype._parse=function(a,b){if(!a||0===
a.byteLength)return E.resolve([]);this.status=2;return(new c(a,this,b)).parse()},a}();return z.pool=new q(z),z})},"esri/core/executeAsync":function(){define(["require","exports","dojo/Deferred","./now"],function(z,a,d,E){return function(a,q){var m;(!q||0>=q)&&(q=500);var b=new d(function(){m&&clearTimeout(m)}),c=function(){if(!b.isFulfilled()){for(var h=E(),f=!1;!f&&E()-h<q;)f=!0===a();f?b.resolve():m=setTimeout(c,0)}};return m=setTimeout(c,0),b.promise}})},"esri/views/vectorTiles/VertexMemoryBuffer":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper ./MemoryBuffer ./GeometryUtils".split(" "),
function(z,a,d,E,x,q){Object.defineProperty(a,"__esModule",{value:!0});z=function(a){function b(){return a.call(this,12)||this}return d(b,a),b.prototype.add=function(a,b,f,k,l,A,d){var c=this.array,h=this.index;a=x.i1616to32(a,b);c.push(a);return a=x.i8888to32(Math.round(31*f),Math.round(31*k),Math.round(31*l),Math.round(31*A)),c.push(a),a=x.i1616to32(d,0),c.push(a),h},b}(x);a.LineMemoryBuffer=z;z=function(a){function b(){return a.call(this,4)||this}return d(b,a),b.prototype.add=function(a,b){var c=
this.index;return this.array.push(x.i1616to32(a,b)),c},b}(x);a.LineJoinMemoryBuffer=z;z=function(a){function b(){return a.call(this,4)||this}return d(b,a),b.prototype.add=function(a,b){this.array.push(x.i1616to32(a,b))},b}(x);a.PolygonMemoryBuffer=z;z=function(a){function b(){return a.call(this,8)||this}return d(b,a),b.prototype.add=function(a,b,f,k,l,A){var c=this.array,h=this.index;a=x.i1616to32(a,b);c.push(a);return a=x.i8888to32(Math.round(15*f),Math.round(15*k),l,A),c.push(a),h},b}(x);a.PolygonOutlineMemoryBuffer=
z;z=function(a){function b(){return a.call(this,16)||this}return d(b,a),b.prototype.add=function(a,b,f,k,l,A,d,p,r,B){var c=this.array,h=this.index;a=x.i1616to32(a,b);return c.push(a),a=x.i1616to32(Math.round(32*f),Math.round(32*k)),c.push(a),a=x.i8888to32(l/4,A/4,0,0),c.push(a),a=x.i8888to32(Math.ceil(10*B),q.radToByte(d),10*p,10*Math.min(r,25)),c.push(a),h},b}(x);a.SymbolMemoryBuffer=z})},"esri/views/vectorTiles/MemoryBuffer":function(){define(["require","exports"],function(z,a){return function(){function a(a){this._array=
[];0>=a&&console.error("strideInBytes must be positive!");this._stride=a}return Object.defineProperty(a.prototype,"array",{get:function(){return this._array},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"index",{get:function(){return 4*this._array.length/this._stride},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"itemSize",{get:function(){return this._stride},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"sizeInBytes",{get:function(){return 4*
this._array.length},enumerable:!0,configurable:!0}),a.prototype.reset=function(){this.array.length=0},a.prototype.toBuffer=function(){return(new Uint32Array(this._array)).buffer},a.i1616to32=function(a,d){return 65535&a|d<<16},a.i8888to32=function(a,d,q,m){return 255&a|(255&d)<<8|(255&q)<<16|m<<24},a.i8816to32=function(a,d,q){return 255&a|(255&d)<<8|q<<16},a}()})},"esri/views/vectorTiles/IndexMemoryBuffer":function(){define(["require","exports","../../core/tsSupport/extendsHelper","../../core/tsSupport/decorateHelper",
"./MemoryBuffer"],function(z,a,d,E,x){Object.defineProperty(a,"__esModule",{value:!0});z=function(a){function m(){return a.call(this,12)||this}return d(m,a),m.prototype.add=function(a,c,h){var b=this.array;b.push(a);b.push(c);b.push(h)},m}(x);a.TriangleElementMemoryBuffer=z;x=function(a){function m(){return a.call(this,4)||this}return d(m,a),m.prototype.add=function(a){this.array.push(a)},m}(x);a.PointElementMemoryBuffer=x})},"esri/views/vectorTiles/TileParser":function(){define("require exports dojo/promise/all ../../core/promiseUtils ../../core/executeAsync ../../core/pbf ./SourceLayerData ./Feature ./BackgroundBucket ./FillBucket ./LineBucket ./SymbolBucket ./TileClipper".split(" "),
function(z,a,d,E,x,q,m,b,c,h,f,k,l){return function(){function a(a,b,c){this._pbfTile=new q(new Uint8Array(a),new DataView(a));this._tile=b;this._connection=c;this._layers=b.getLayers();c=b.tileKey.split("/").map(parseFloat);var f=c[0];a=c[1];c=c[2];this._level=f;b.refKey&&(b=b.refKey.split("/").map(parseFloat)[0],b=f-b,0<b&&(f=(1<<b)-1,this._tileClipper=new l.TileClipper(b,a&f,c&f)));this._tileClipper||(this._tileClipper=new l.SimpleBuilder)}return a.prototype.parse=function(){for(var a,c=this,f=
this._parseTileData(this._pbfTile),h=this._layers,k=h.length,l=this._level,A=[],w={},n=new Set,k=k-1;0<=k;k--)if(a=h[k],!(a.minzoom&&l<a.minzoom||a.maxzoom&&l>=a.maxzoom||a.layout&&"none"===a.layout.visibility))if(0!==a.type){var D=a.sourceLayer,K=f[D];if(K){n.add(D);var m=this._createBucket(a);m&&(m.layerIndex=k,m.layerExtent=K.extent,(K=w[D])||(K=w[D]=[]),K.push(m))}}else m=this._createBucket(a),A.push(m);var O=10*(this._level+1),P=[],V=[],v=[],F=[],t=this._tileClipper,J=new Set,T={},q=[];n.forEach(function(a){return q.push(a)});
var L=0,R=0,Q=q.length;return x(function(){if(6===c._tile.status)return!0;switch(L){case 0:if(Q>R){var a=q[R++],h=f[a],k=w[a];if(k&&0!==k.length)for(a=h.getData();a.next(2);){var n=new b(a.getMessage(),h),l=n.values;if(l&&(l=l._minzoom)&&l>=O)continue;for(var A=0,d=k;A<d.length;A++)l=d[A],l.pushFeature(n)}}else{h=c._tile;for(a in w)for(k=w[a],n=0;n<k.length;n++)l=k[n],l.hasFeatures()&&(3===l.layer.type?(P.push(l),h.addBucket(l)):l.layer.refLayerId?v.push(l):(V.push(l),F[l.layer.id]=l));L=1;R=0;Q=
P.length}break;case 1:Q>R?P[R++].getResources(t,J,T):L=2}return 2===L},50).then(function(){if(6===c._tile.status)return[];var a,b=[],f=c._tile.getWorkerTileHandler();0<J.size&&(a=f.fetchSprites(J,c._connection),b.push(a));var h,k;for(k in T)a=T[k],0<a.size&&(h=f.fetchGlyphs(c._tile.tileKey,k,a,c._connection),b.push(h));return d(b).then(function(a){if(6===c._tile.status)return[];var b=0,f=0,h=V.length;return x(function(){if(6===c._tile.status)return!0;switch(b){case 0:if(h>f){var a=V[f++];a.processFeatures(t,
c._tile);A.push(a)}else b=1,f=0,h=v.length;break;case 1:for(var k=0;k<v.length;k++){var a=v[k],n=F[a.layer.refLayerId];n&&(n.assignBufferInfo(a),A.push(a))}b=2;f=0;h=P.length;break;case 2:h>f?(a=P[f++],a.processFeatures(t,c._tile),A.push(a)):b=3}return 3===b},50).then(function(){return A.sort(function(a,b){return a.layerIndex-b.layerIndex}),A})}).otherwise(function(a){return E.reject(Error(a))})}).otherwise(function(a){return E.reject(Error(a))})},a.prototype._parseTileData=function(a){for(var b=
{};a.next();)switch(a.tag()){case 3:var c=new m(a.getMessage());b[c.name]=c;break;default:a.skip()}return b},a.prototype._createBucket=function(a){switch(a.type){case 0:return this._createBackgroundBucket(a);case 1:return this._createFillBucket(a);case 2:return this._createLineBucket(a);case 3:return this._createSymbolBucket(a)}},a.prototype._createBackgroundBucket=function(a){return new c(a,this._level)},a.prototype._createFillBucket=function(a){var b=this._tile;return new h(a,this._level,b.polygonVertexBuffer,
b.polygonIndexBuffer,b.polygonOutlineVertexBuffer,b.polygonOutlineIndexBuffer)},a.prototype._createLineBucket=function(a){var b=this._tile;return new f(a,this._level,b.lineVertexBuffer,b.lineIndexBuffer)},a.prototype._createSymbolBucket=function(a){var b=this._tile;return new k(a,this._level,b.markerVertexBuffer,b.markerIndexBuffer,b.textVertexBuffer,b.textIndexBuffer,b.placementEngine,b.getWorkerTileHandler())},a}()})},"esri/views/vectorTiles/SourceLayerData":function(){define(["require","exports"],
function(z,a){return function(){function a(d){this.extent=4096;this.keys=[];this.values=[];for(this._pbfLayer=d.clone();d.next();)switch(d.tag()){case 1:this.name=d.getString();break;case 3:this.keys.push(d.getString());break;case 4:this.values.push(a._parseValue(d.getMessage()));break;case 5:this.extent=d.getUInt32();break;default:d.skip()}}return a.prototype.getData=function(){return this._pbfLayer},a._parseValue=function(a){for(;a.next();)switch(a.tag()){case 1:return a.getString();case 2:return a.getFloat();
case 3:return a.getDouble();case 4:return a.getInt64();case 5:return a.getUInt64();case 6:return a.getSInt64();case 7:return a.getBool();default:a.skip()}return null},a}()})},"esri/views/vectorTiles/Feature":function(){define(["require","exports","./Geometry"],function(z,a,d){return function(){function a(a,d){this.values={};var m=d.keys;for(d=d.values;a.next();)switch(a.tag()){case 1:this.id=a.getUInt64();break;case 2:for(var b=a.getMessage(),c=this.values;!b.empty();){var h=b.getUInt32(),f=b.getUInt32();
c[m[h]]=d[f]}break;case 3:this.type=a.getUInt32();break;case 4:this._pbfGeometry=a.getMessage();break;default:a.skip()}}return a.prototype.getGeometry=function(a){if(void 0!==this._geometry)return this._geometry;var E,m,b=this._pbfGeometry;a?a.reset(this.type):E=[];for(var c=1,h=0,f=0,k=0;!b.empty();)switch(0===h&&(h=b.getUInt32(),c=7&h,h>>=3),h--,c){case 1:f+=b.getSInt32();k+=b.getSInt32();a?a.moveTo(f,k):(m&&E.push(m),m=[],m.push(new d.Point(f,k)));break;case 2:f+=b.getSInt32();k+=b.getSInt32();
a?a.lineTo(f,k):m.push(new d.Point(f,k));break;case 7:a?a.close():m&&!m[0].equals(f,k)&&m.push(m[0].clone());break;default:throw Error("Invalid path operation");}var l;return a?l=a.result():(m&&E.push(m),l=E),this._geometry=l,l},a}()})},"esri/views/vectorTiles/Geometry":function(){define(["require","exports"],function(z,a){Object.defineProperty(a,"__esModule",{value:!0});z=function(){function a(a,d){this.x=a;this.y=d}return a.prototype.clone=function(){return new a(this.x,this.y)},a.prototype.equals=
function(a,d){return a===this.x&&d===this.y},a.prototype.isEqual=function(a){return a.x===this.x&&a.y===this.y},a.prototype.setCoords=function(a,d){this.x=a;this.y=d},a.prototype.normalize=function(){var a=this.x,d=this.y,a=Math.sqrt(a*a+d*d);this.x/=a;this.y/=a},a.prototype.rightPerpendicular=function(){var a=this.x;this.x=this.y;this.y=-a},a.prototype.move=function(a,d){this.x+=a;this.y+=d},a.prototype.assign=function(a){this.x=a.x;this.y=a.y},a.prototype.assignAdd=function(a,d){this.x=a.x+d.x;
this.y=a.y+d.y},a.prototype.assignSub=function(a,d){this.x=a.x-d.x;this.y=a.y-d.y},a.prototype.rotate=function(a,d){var q=this.x,m=this.y;this.x=q*a-m*d;this.y=q*d+m*a},a.prototype.scale=function(a){this.x*=a;this.y*=a},a.prototype.length=function(){var a=this.x,d=this.y;return Math.sqrt(a*a+d*d)},a.distance=function(a,d){var q=d.x-a.x;a=d.y-a.y;return Math.sqrt(q*q+a*a)},a.add=function(d,x){return new a(d.x+x.x,d.y+x.y)},a.sub=function(d,x){return new a(d.x-x.x,d.y-x.y)},a}();a.Point=z})},"esri/views/vectorTiles/BackgroundBucket":function(){define(["require",
"exports","../../core/tsSupport/extendsHelper","../../core/tsSupport/decorateHelper","./Bucket"],function(z,a,d,E,x){return function(a){function m(b,c){return a.call(this,b,c)||this}return d(m,a),m}(x)})},"esri/views/vectorTiles/Bucket":function(){define(["require","exports"],function(z,a){return function(){function a(a,d){this.layerExtent=4096;this._features=[];this.layer=a;this.zoom=d;this._filter=a.getFeatureFilter()}return a.prototype.pushFeature=function(a){this._filter.filter(a)&&this._features.push(a)},
a.prototype.hasFeatures=function(){return 0<this._features.length},a.prototype.processFeatures=function(a,d){},a.prototype.assignBufferInfo=function(a){},a}()})},"esri/views/vectorTiles/FillBucket":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper ./Bucket ./Geometry ../../core/libs/earcut/earcut".split(" "),function(z,a,d,E,x,q,m){return function(a){function b(b,c,k,l,d,y){b=a.call(this,b,c)||this;return b.polygonVertexBuffer=k,b.polygonIndexBuffer=
l,b.polygonOutlineVertexBuffer=d,b.polygonOutlineIndexBuffer=y,b}return d(b,a),Object.defineProperty(b.prototype,"polygonIndexStart",{get:function(){return this._triangleElementsStart},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"polygonIndexCount",{get:function(){return this._triangleElementsNum},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"polygonOutlineIndexStart",{get:function(){return this._outlineElementsStart},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,
"polygonOutlineIndexCount",{get:function(){return this._outlineElementsNum},enumerable:!0,configurable:!0}),b.prototype.assignBufferInfo=function(a){a._triangleElementsStart=this._triangleElementsStart;a._triangleElementsNum=this._triangleElementsNum;a.layer.hasPaintProperty("fill-outline-color")?(a._outlineElementsStart=this._outlineElementsStart,a._outlineElementsNum=this._outlineElementsNum):(a._outlineElementsStart=0,a._outlineElementsNum=0)},b.prototype.processFeatures=function(a,b){this._triangleElementsStart=
this.polygonIndexBuffer.index;this._triangleElementsNum=0;this._outlineElementsStart=this.polygonOutlineIndexBuffer.index;this._outlineElementsNum=0;a&&a.setExtent(this.layerExtent);b=this.layer.getPaintValue("fill-pattern",this.zoom);b=this.layer.getPaintValue("fill-antialias",this.zoom)&&void 0===b;for(var c=0,f=this._features;c<f.length;c++){var h=f[c].getGeometry(a);this._processFeature(h,b)}},b.prototype._processFeature=function(a,c){if(a){var f=a.length;if(c)for(c=0;f>c;c++)this._processOutline(a[c]);
var h;for(c=0;f>c;c++){var d=b._area(a[c]);128<d?(void 0!==h&&this._processFill(a,h),h=[c]):-128>d&&void 0!==h&&h.push(c)}void 0!==h&&this._processFill(a,h)}},b.prototype._processOutline=function(a){var b,c,h,d=this.polygonOutlineVertexBuffer,y=this.polygonOutlineIndexBuffer,p=y.index,r=new q.Point(0,0),B=new q.Point(0,0),m=new q.Point(0,0),H=-1,C=-1,w=-1,n=-1,D=-1,K=a.length;if(!(2>K)){for(var I=a[0],O=a[K-1];K&&O.isEqual(I);)--K,O=a[K-1];if(!(2>K-0)){for(I=0;K>I;++I){0===I?(b=a[K-1],c=a[0],h=a[1],
r.assignSub(c,b),r.normalize(),r.rightPerpendicular()):(b=c,c=h,h=I!==K-1?a[I+1]:a[0],r.assign(B));B.assignSub(h,c);B.normalize();B.rightPerpendicular();O=r.x*B.y-r.y*B.x;m.assignAdd(r,B);m.normalize();var P=-m.x*-r.x+-m.y*-r.y,P=Math.abs(0!==P?1/P:1);8<P&&(P=8);0<=O?(w=d.add(c.x,c.y,r.x,r.y,0,1),-1===n&&(n=w),0<=H&&0<=C&&0<=w&&y.add(H,C,w),C=d.add(c.x,c.y,P*-m.x,P*-m.y,0,-1),-1===D&&(D=C),0<=H&&0<=C&&0<=w&&y.add(H,C,w),H=C,C=w,w=d.add(c.x,c.y,m.x,m.y,0,1),0<=H&&0<=C&&0<=w&&y.add(H,C,w),C=d.add(c.x,
c.y,B.x,B.y,0,1),0<=H&&0<=C&&0<=w&&y.add(H,C,w)):(w=d.add(c.x,c.y,P*m.x,P*m.y,0,1),-1===n&&(n=w),0<=H&&0<=C&&0<=w&&y.add(H,C,w),C=d.add(c.x,c.y,-r.x,-r.y,0,-1),-1===D&&(D=C),0<=H&&0<=C&&0<=w&&y.add(H,C,w),H=C,C=w,w=d.add(c.x,c.y,-m.x,-m.y,0,-1),0<=H&&0<=C&&0<=w&&y.add(H,C,w),H=d.add(c.x,c.y,-B.x,-B.y,0,-1),0<=H&&0<=C&&0<=w&&y.add(H,C,w))}0<=H&&0<=C&&0<=n&&y.add(H,C,n);0<=H&&0<=n&&0<=D&&y.add(H,D,n);this._outlineElementsNum+=3*(y.index-p)}}},b.prototype._processFill=function(a,b){var c;1<b.length&&
(c=[]);for(var f=0,h=0;h<b.length;h++){var d=b[h];0!==f&&c.push(f);f+=a[d].length}for(var f=2*f,h=new Float64Array(f),p=0,r=0;r<b.length;r++)for(var d=b[r],d=a[d],B=d.length,G=0;B>G;++G)h[p++]=d[G].x,h[p++]=d[G].y;a=m(h,c,2);b=a.length;if(0<b){c=this.polygonVertexBuffer.index;for(p=0;f>p;)this.polygonVertexBuffer.add(h[p++],h[p++]);for(f=0;b>f;)this.polygonIndexBuffer.add(c+a[f++],c+a[f++],c+a[f++]);this._triangleElementsNum+=b}},b._area=function(a){for(var b=0,c=a.length-1,h=0;c>h;h++)b+=(a[h].x-
a[h+1].x)*(a[h].y+a[h+1].y);return b+=(a[c].x-a[0].x)*(a[c].y+a[0].y),.5*b},b}(x)})},"esri/core/libs/earcut/earcut":function(){define([],function(){function z(b,f,h){h=h||2;H=b.length/h+(f?2*f.length:0);C=!1;var n=f&&f.length,w=n?f[0]*h:b.length,k=a(b,0,w,h,!0),l=[];if(!k)return l;var r,v,F,t;if(n)a:{var A=h,D,p,B;t=[];n=0;for(D=f.length;D>n;n++)p=f[n]*A,B=D-1>n?f[n+1]*A:b.length,p=a(b,p,B,A,!1),p===p.next&&(p.steiner=!0),t.push(c(p));t.sort(q);for(n=0;n<t.length;n++){if(!k){k=null;break a}f=t[n];
A=k;if(A=m(f,A))f=y(A,f),d(f,f.next);k=d(k,k.next)}}if(C)return l;if(b.length>80*h){r=F=b[0];v=n=b[1];for(A=h;w>A;A+=h)t=b[A],f=b[A+1],r>t&&(r=t),v>f&&(v=f),t>F&&(F=t),f>n&&(n=f);F=Math.max(F-r,n-v)}return E(k,l,h,r,v,F),l}function a(a,b,c,f,h){var n;if(h===0<G(a,b,c,f))for(h=b;c>h;h+=f)n=p(h,a[h],a[h+1],n);else for(h=c-f;h>=b;h-=f)n=p(h,a[h],a[h+1],n);return n&&k(n,n.next)&&(r(n),n=n.next),n}function d(a,b){if(!a)return a;b||(b=a);var c=a,h=0,n=H*H/2;do{if(a=!1,c.steiner||!k(c,c.next)&&0!==f(c.prev,
c,c.next))c=c.next;else{if(r(c),c=b=c.prev,c===c.next)return null;a=!0}if(h++>n)return C=!0,null}while(a||c!==b);return b}function E(a,c,p,m,B,H,G){if(a){if(!G&&H){var n=a,v=n;do null===v.z&&(v.z=b(v.x,v.y,m,B,H)),v.prevZ=v.prev,v=v.nextZ=v.next;while(v!==n);v.prevZ.nextZ=null;v.prevZ=null;var n=v,F,t,w,D,K,L,I=1;do{v=n;D=n=null;for(K=0;v;){K++;t=v;for(F=L=0;I>F&&(L++,t=t.nextZ,t);F++);for(F=I;0<L||0<F&&t;)0===L?(w=t,t=t.nextZ,F--):0!==F&&t?v.z<=t.z?(w=v,v=v.nextZ,L--):(w=t,t=t.nextZ,F--):(w=v,v=
v.nextZ,L--),D?D.nextZ=w:n=w,w.prevZ=D,D=w;v=t}D.nextZ=null;I*=2}while(1<K)}for(v=a;a.prev!==a.next;){w=a.prev;n=a.next;if(H)a:{t=a;F=m;var q=B,O=H;D=t.prev;K=t;L=t.next;if(0<=f(D,K,L))t=!1;else{var P=D.x>K.x?D.x>L.x?D.x:L.x:K.x>L.x?K.x:L.x,z=D.y>K.y?D.y>L.y?D.y:L.y:K.y>L.y?K.y:L.y,I=b(D.x<K.x?D.x<L.x?D.x:L.x:K.x<L.x?K.x:L.x,D.y<K.y?D.y<L.y?D.y:L.y:K.y<L.y?K.y:L.y,F,q,O);F=b(P,z,F,q,O);for(q=t.nextZ;q&&q.z<=F;){if(q!==t.prev&&q!==t.next&&h(D.x,D.y,K.x,K.y,L.x,L.y,q.x,q.y)&&0<=f(q.prev,q,q.next)){t=
!1;break a}q=q.nextZ}for(q=t.prevZ;q&&q.z>=I;){if(q!==t.prev&&q!==t.next&&h(D.x,D.y,K.x,K.y,L.x,L.y,q.x,q.y)&&0<=f(q.prev,q,q.next)){t=!1;break a}q=q.prevZ}t=!0}}else t=x(a);if(t)c.push(w.i/p),c.push(a.i/p),c.push(n.i/p),r(a),v=a=n.next;else{if(C)break;if(a=n,a===v){if(G)if(1===G){G=c;w=p;n=a;do v=n.prev,t=n.next.next,!k(v,t)&&l(v,n,n.next,t)&&A(v,t)&&A(t,v)&&(G.push(v.i/w),G.push(n.i/w),G.push(t.i/w),r(n),r(n.next),n=a=t),n=n.next;while(n!==a);a=n;E(a,c,p,m,B,H,2)}else{if(2===G)a:{G=a;do{for(w=G.next.next;w!==
G.prev;){if(n=G.i!==w.i){n=G;v=w;t=void 0;if(t=n.next.i!==v.i&&n.prev.i!==v.i){t=void 0;b:{t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==v.i&&t.next.i!==v.i&&l(t,t.next,n,v)){t=!0;break b}t=t.next}while(t!==n);t=!1}t=!t}D=void 0;if(D=t&&A(n,v)&&A(v,n)){t=n;D=!1;K=(n.x+v.x)/2;v=(n.y+v.y)/2;do t.y>v!=t.next.y>v&&K<(t.next.x-t.x)*(v-t.y)/(t.next.y-t.y)+t.x&&(D=!D),t=t.next;while(t!==n)}n=D}if(n){a=y(G,w);G=d(G,G.next);a=d(a,a.next);E(G,c,p,m,B,H);E(a,c,p,m,B,H);break a}w=w.next}G=G.next}while(G!==a)}}else E(d(a),
c,p,m,B,H,1);break}}}}}function x(a){var b=a.prev,c=a.next;if(0<=f(b,a,c))return!1;for(var k=a.next.next,d=0;k!==a.prev;){if(h(b.x,b.y,a.x,a.y,c.x,c.y,k.x,k.y)&&0<=f(k.prev,k,k.next))return!1;if(k=k.next,d++>H)return C=!0,!1}return!0}function q(a,b){return a.x-b.x}function m(a,b){var c,f=b,n=a.x,k=a.y,d=-(1/0);do{if(!f)return null;if(k<=f.y&&k>=f.next.y){var w=f.x+(k-f.y)*(f.next.x-f.x)/(f.next.y-f.y);if(n>=w&&w>d){if(d=w,w===n){if(k===f.y)return f;if(k===f.next.y)return f.next}c=f.x<f.next.x?f:f.next}}f=
f.next}while(f!==b);if(!c)return null;if(n===d)return c.prev;var v;b=c;for(var w=c.x,F=c.y,t=1/0,f=c.next;f!==b;)n>=f.x&&f.x>=w&&h(F>k?n:d,k,w,F,F>k?d:n,k,f.x,f.y)&&(v=Math.abs(k-f.y)/(n-f.x),(t>v||v===t&&f.x>c.x)&&A(f,a)&&(c=f,t=v)),f=f.next;return c}function b(a,b,c,f,h){return a=32767*(a-c)/h,b=32767*(b-f)/h,a=16711935&(a|a<<8),a=252645135&(a|a<<4),a=858993459&(a|a<<2),a=1431655765&(a|a<<1),b=16711935&(b|b<<8),b=252645135&(b|b<<4),b=858993459&(b|b<<2),b=1431655765&(b|b<<1),a|b<<1}function c(a){var b=
a,c=a;do b.x<c.x&&(c=b),b=b.next;while(b!==a);return c}function h(a,b,c,f,h,k,d,l){return 0<=(h-d)*(b-l)-(a-d)*(k-l)&&0<=(a-d)*(f-l)-(c-d)*(b-l)&&0<=(c-d)*(k-l)-(h-d)*(f-l)}function f(a,b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y)}function k(a,b){return a.x===b.x&&a.y===b.y}function l(a,b,c,h){return k(a,b)&&k(c,h)||k(a,h)&&k(c,b)?!0:0<f(a,b,c)!=0<f(a,b,h)&&0<f(c,h,a)!=0<f(c,h,b)}function A(a,b){return 0>f(a.prev,a,a.next)?0<=f(a,b,a.next)&&0<=f(a,a.prev,b):0>f(a,b,a.prev)||0>f(a,a.next,b)}
function y(a,b){var c=new B(a.i,a.x,a.y),f=new B(b.i,b.x,b.y),h=a.next,k=b.prev;return a.next=b,b.prev=a,c.next=h,h.prev=c,f.next=c,c.prev=f,k.next=f,f.prev=k,f}function p(a,b,c,f){a=new B(a,b,c);return f?(a.next=f.next,a.prev=f,f.next.prev=a,f.next=a):(a.prev=a,a.next=a),a}function r(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function B(a,b,c){this.i=a;this.x=b;this.y=c;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=
!1}function G(a,b,c,f){for(var h=0,k=c-f;c>b;b+=f)h+=(a[k]-a[b])*(a[b+1]+a[k+1]),k=b;return h}var H,C;return z.deviation=function(a,b,c,f){var h=b&&b.length,k=Math.abs(G(a,0,h?b[0]*c:a.length,c));if(h)for(var h=0,d=b.length;d>h;h++)k-=Math.abs(G(a,b[h]*c,d-1>h?b[h+1]*c:a.length,c));for(h=b=0;h<f.length;h+=3){var d=f[h]*c,n=f[h+1]*c,v=f[h+2]*c;b+=Math.abs((a[d]-a[v])*(a[n+1]-a[d+1])-(a[d]-a[n])*(a[v+1]-a[d+1]))}return 0===k&&0===b?0:Math.abs((b-k)/k)},z.flatten=function(a){for(var b=a[0][0].length,
c={vertices:[],holes:[],dimensions:b},f=0,h=0;h<a.length;h++){for(var k=0;k<a[h].length;k++)for(var d=0;b>d;d++)c.vertices.push(a[h][k][d]);0<h&&(f+=a[h-1].length,c.holes.push(f))}return c},z})},"esri/views/vectorTiles/LineBucket":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper ./Bucket ./LineTess ./style/StyleLayer".split(" "),function(z,a,d,E,x,q,m){return function(a){function b(b,c,k,d){b=a.call(this,b,c)||this;return b.extrudeVectorsDoubleBuffer=
[q.allocExtrudeVectors(),q.allocExtrudeVectors()],b.firstExtrudeVectors=q.allocExtrudeVectors(),b.recycledTriangleBridge=q.allocTriangles(20),b.recycledTrianglePie=q.allocTriangles(20),b.lineVertexBuffer=k,b.lineIndexBuffer=d,b}return d(b,a),Object.defineProperty(b.prototype,"triangleIndexStart",{get:function(){return this.triangleElementsStart},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"triangleIndexCount",{get:function(){return this.triangleElementsCount},enumerable:!0,configurable:!0}),
Object.defineProperty(b.prototype,"connectorStart",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"connectorCount",{get:function(){return 0},enumerable:!0,configurable:!0}),b.prototype.assignBufferInfo=function(a){a.triangleElementsStart=this.triangleElementsStart;a.triangleElementsCount=this.triangleElementsCount},b.prototype.processFeatures=function(a,b){this.triangleElementsStart=this.lineIndexBuffer.index;this.triangleElementsCount=0;a&&a.setExtent(this.layerExtent);
b=new m.LineLayout(this.layer,this.zoom);for(var c=0,f=this._features;c<f.length;c++){var h=f[c].getGeometry(a);this._processFeature(b,h)}},b.prototype._processFeature=function(a,b){if(b){var c,f=b.length;for(c=0;f>c;c++)this._processGeometry(b[c],a)}},b.prototype._processGeometry=function(a,b){if(!(2>a.length)){var c=a[0],f=a[a.length-1],h=f.x-c.x,f=f.y-c.y,c=1E-6>h*h+f*f;if(!(2>a.length)){for(var d=a[0],p=1;p<a.length;)h=a[p].x-d.x,f=a[p].y-d.y,1E-6>h*h+f*f?a.splice(p,1):(d=a[p],++p);if(!(2>a.length)){this.vertices=
a;this.verticesLen=a.length;this.isClosed=c;this.cap=b.cap;this.join=b.join;this.almostParallelRads=.05;this.veryShallowRads=.1;this.miterSafeRads=q.MITER_SAFE_RADS;this.miterLimitMag=Math.min(b.miterLimit,q.SYSTEM_MAG_LIMIT);this.roundLimitRads=Math.min(b.roundLimit,.5);this.newRoundJoinsSafeRads=2.3;var h=this.lineIndexBuffer.index,f=0,r=void 0,d=this.verticesLen;for(b=0;d>b;++b){var m=a[b],p=r===this.extrudeVectorsDoubleBuffer[b%2]?this.extrudeVectorsDoubleBuffer[(b+1)%2]:this.extrudeVectorsDoubleBuffer[b%
2];if(d>b||!c?(this._computeExtrudeVectors(p,b),this._writeGPUVertices(m.x,m.y,f,p),!p.capCenter||c&&b===d-1||this._writeGPUPieElements(p),c&&0===b&&q.copyExtrudeVectors(this.firstExtrudeVectors,p)):q.copyExtrudeVectors(p,this.firstExtrudeVectors),r&&this._writeGPUBridgeElements(r,p),d-1>b)r=a[b+1],m=q.length([r.x-m.x,r.y-m.y]),f+=m;r=p}this.triangleElementsCount+=3*(this.lineIndexBuffer.index-h)}}}},b.prototype._computeExtrudeVectors=function(a,b){var c=this.vertices,f=this.verticesLen,h=this.isClosed,
d=c[b],p=[void 0,void 0],r=[void 0,void 0];if(0<b&&f-1>b){var m=c[(b+f-1)%f],G=c[(b+1)%f];q.normalize(p,[d.x-m.x,d.y-m.y]);q.normalize(r,[G.x-d.x,G.y-d.y])}else if(0===b)G=c[(b+1)%f],(q.normalize(r,[G.x-d.x,G.y-d.y]),h)?(c=c[f-2],q.normalize(p,[d.x-c.x,d.y-c.y])):p=r;else{if(b!==f-1)return void console.error("Vertex index 'i' out of range.");m=c[(b+f-1)%f];(q.normalize(p,[d.x-m.x,d.y-m.y]),h)?(c=c[1],q.normalize(r,[c.x-d.x,c.y-d.y])):r=p}h||0!==b?h||b!==f-1?this._computeJoinExtrudeVectors(a,p,r):
this._computeCapExtrudeVectors(a,p,r,q.CapPosition.END):this._computeCapExtrudeVectors(a,p,r,q.CapPosition.START)},b.prototype._computeCapExtrudeVectors=function(a,b,c,d){0===this.cap?q.buttCap(a,b,c):1===this.cap?q.roundCap(a,b,c,d,q.getNumberOfSlices(Math.PI),d===q.CapPosition.START?-1:1):2===this.cap?q.squareCap(a,b,c,d):(q.buttCap(a,b,c),console.error("Unknown cap type!"))},b.prototype._computeJoinExtrudeVectors=function(a,b,c){var f=q.getRads(b,c);if(f>Math.PI-this.almostParallelRads)q.rectJoin(a,
b,c);else if(2===this.join||f<this.veryShallowRads)f<this.almostParallelRads?q.fastMiterJoin(a,b,c):f<this.miterSafeRads?q.miterJoin(a,b,c):q.bevelJoin(a,b,c,this.miterLimitMag);else if(0===this.join)q.bevelJoin(a,b,c,1);else if(1===this.join){var h=q.getNumberOfSlices(f);f<this.newRoundJoinsSafeRads?2>h||f<this.roundLimitRads?q.bevelJoin(a,b,c,1):q.roundJoin(a,b,c,h):q.unitRoundJoin(a,b,c,h)}},b.prototype._writeGPUVertices=function(a,b,c,d){var f;for(f=0;f<d.vectors.count;++f){var h=this.lineVertexBuffer.add(a,
b,d.vectors.items[f].vector[0],d.vectors.items[f].vector[1],d.vectors.items[f].texCoords[0],d.vectors.items[f].texCoords[1],c);d.vectors.items[f].base=h}},b.prototype._writeGPUBridgeElements=function(a,b){q.bridge(this.recycledTriangleBridge,a,b);for(a=0;a<this.recycledTriangleBridge.count;++a)b=this.recycledTriangleBridge.items[a],this.lineIndexBuffer.add(b.v1.base,b.v2.base,b.v3.base)},b.prototype._writeGPUPieElements=function(a){q.pie(this.recycledTrianglePie,a);for(a=0;a<this.recycledTrianglePie.count;++a){var b=
this.recycledTrianglePie.items[a];this.lineIndexBuffer.add(b.v1.base,b.v2.base,b.v3.base)}},b}(x)})},"esri/views/vectorTiles/LineTess":function(){define(["require","exports"],function(z,a){function d(a){var b,c={items:[],count:0};for(b=0;a>b;++b)c.items.push(void 0);return c}function E(a,b){return a[0]*b[0]+a[1]*b[1]}function x(a){return Math.sqrt(E(a,a))}function q(a,b){var c=x(b);return a[0]=b[0]/c,a[1]=b[1]/c,a}function m(a,b){return a[0]=-b[1],a[1]=b[0],a}function b(a,b){return a[0]*b[1]-a[1]*
b[0]}function c(a,b){return a[0]=-b[0],a[1]=-b[1],a}function h(a,b,c){return a[0]=b[0]*c,a[1]=b[1]*c,a}function f(a,b,c){return a[0]=b[0]+c[0],a[1]=b[1]+c[1],a}function k(a,b){a=E(a,b);return.999<a?0:-.999>a?Math.PI:Math.acos(a)}function l(a,b,c,f,d){if(0===f)return void(a.count=0);var t=x(b),v=h(n[0],b,1/t);c=h(n[1],c,1/t);v=k(v,c);v=(d?-1:1)*v/f;d=Math.cos(v);v=Math.sin(v);c=b[0];var F=b[1];for(b=0;f-1>b;++b)t=c,c=d*t-v*F,F=v*t+d*F,a.items[b][0]=c,a.items[b][1]=F;a.count=f-1}function A(a){var b,
c=a.count,f=Math.floor(c/2);for(b=0;f>b;++b){var h=a.items[b];a.items[b]=a.items[c-b-1];a.items[c-b-1]=h}}function y(a,b,f){f=m(n[0],f);b=c(n[1],f);var h=a.vectors.items[0];h.vector[0]=f[0];h.vector[1]=f[1];h.texCoords[0]=C;h.texCoords[1]=G;f=a.vectors.items[1];f.vector[0]=b[0];f.vector[1]=b[1];f.texCoords[0]=C;f.texCoords[1]=H;a.vectors.count=2;b=a.lists[p.ENTRY];b.items[0]=0;b.items[1]=1;b.count=2;b=a.lists[p.EXIT];b.items[0]=0;b.items[1]=1;b.count=2;a.lists[p.CAP].count=0;a.capCenter=void 0}Object.defineProperty(a,
"__esModule",{value:!0});var p;!function(a){a[a.ENTRY=1]="ENTRY";a[a.EXIT=2]="EXIT";a[a.CAP=3]="CAP"}(p=a.VectorRole||(a.VectorRole={}));var r;!function(a){a[a.START=1]="START";a[a.END=2]="END"}(r=a.CapPosition||(a.CapPosition={}));a.SYSTEM_MAG_LIMIT=3.8;a.MITER_SAFE_RADS=2*Math.acos(1/a.SYSTEM_MAG_LIMIT);var B=a.SYSTEM_MAG_LIMIT*a.SYSTEM_MAG_LIMIT,G=-1,H=1,C=0,w=16/(2*Math.PI);a.allocTriangles=function(a){var b,c={items:[],count:0};for(b=0;a>b;++b)c.items.push({v1:{vector:[void 0,void 0],texCoords:[void 0,
void 0]},v2:{vector:[void 0,void 0],texCoords:[void 0,void 0]},v3:{vector:[void 0,void 0],texCoords:[void 0,void 0]}});return c};a.allocExtrudeVectors=function(){var a,b={items:[],count:0};for(a=0;30>a;++a)b.items.push({vector:[void 0,void 0],texCoords:[void 0,void 0]});a={};a[p.ENTRY]=d(20);a[p.EXIT]=d(20);a[p.CAP]=d(20);return{vectors:b,lists:a}};a.copyExtrudeVectors=function(a,b){var c;for(c=0;c<b.vectors.count;++c)a.vectors.items[c].vector[0]=b.vectors.items[c].vector[0],a.vectors.items[c].vector[1]=
b.vectors.items[c].vector[1],a.vectors.items[c].texCoords[0]=b.vectors.items[c].texCoords[0],a.vectors.items[c].texCoords[1]=b.vectors.items[c].texCoords[1],a.vectors.items[c].base=b.vectors.items[c].base;a.vectors.count=b.vectors.count;a.capCenter=b.capCenter};var n=[];for(z=0;32>z;++z)n.push([void 0,void 0]);var D=function(a){var b,c={items:[],count:0};for(b=0;a>b;++b)c.items.push([void 0,void 0]);return c}(16);a.length=x;a.normalize=q;a.getNumberOfSlices=function(a){return Math.round(a*w)};a.getRads=
k;var K=[void 0,void 0],I=[void 0,void 0];a.bridge=function(a,b,c){var f,h,d=b.vectors,t=b.lists[p.EXIT];h=c.vectors;var k=c.lists[p.ENTRY];if(t.count===k.count+1)c=t.items,b=d.items,f=k.items,h=h.items;else{if(k.count!==t.count+1&&t.count!==k.count)return console.error("Cannot bridge "+t.count+" to "+k.count+"."),void(a.count=0);c=k.items;b=h.items;f=t.items;h=d.items}d=t.count+k.count-2;a.count=d;K[0]=c;K[1]=f;I[0]=b;I[1]=h;for(c=0;d>c;++c)b=a.items[c],f=(c+0)%2,f=I[f][K[f][Math.floor((c+0)/2)]],
b.v1.vector[0]=f.vector[0],b.v1.vector[1]=f.vector[1],b.v1.texCoords[0]=f.texCoords[0],b.v1.texCoords[1]=f.texCoords[1],b.v1.base=f.base,f=(c+1)%2,f=I[f][K[f][Math.floor((c+1)/2)]],b.v2.vector[0]=f.vector[0],b.v2.vector[1]=f.vector[1],b.v2.texCoords[0]=f.texCoords[0],b.v2.texCoords[1]=f.texCoords[1],b.v2.base=f.base,f=(c+2)%2,f=I[f][K[f][Math.floor((c+2)/2)]],b.v3.vector[0]=f.vector[0],b.v3.vector[1]=f.vector[1],b.v3.texCoords[0]=f.texCoords[0],b.v3.texCoords[1]=f.texCoords[1],b.v3.base=f.base};a.pie=
function(a,b){if(0===b.lists[p.CAP].count)return void(a.count=0);if(1===b.lists[p.CAP].count)return console.error("A single vector is not enough to define a pie."),void(a.count=0);a.count=b.lists[p.CAP].count-1;var c;for(c=0;c<a.count;++c){var f=a.items[c],h=b.vectors.items[b.lists[p.CAP].items[c]];f.v1.vector[0]=h.vector[0];f.v1.vector[1]=h.vector[1];f.v1.texCoords[0]=h.texCoords[0];f.v1.texCoords[1]=h.texCoords[1];f.v1.base=h.base;h=b.vectors.items[b.lists[p.CAP].items[c+1]];f.v2.vector[0]=h.vector[0];
f.v2.vector[1]=h.vector[1];f.v2.texCoords[0]=h.texCoords[0];f.v2.texCoords[1]=h.texCoords[1];f.v2.base=h.base;h=b.vectors.items[b.capCenter];f.v3.vector[0]=h.vector[0];f.v3.vector[1]=h.vector[1];f.v3.texCoords[0]=h.texCoords[0];f.v3.texCoords[1]=h.texCoords[1];f.v3.base=h.base}};a.buttCap=function(a,b,c){y(a,b,c)};a.roundCap=function(a,b,c,f,h,d){void 0===d&&(d=0);y(a,b,c);c=f===r.START?0:1;f=f===r.START?1:0;a.capCenter=a.vectors.count;b=a.vectors.items[a.capCenter];b.vector[0]=0;b.vector[1]=0;b.texCoords[0]=
C;b.texCoords[1]=C;++a.vectors.count;l(D,a.vectors.items[c].vector,a.vectors.items[f].vector,h,!1);h=a.vectors.count;b=a.lists[p.CAP];b.items[0]=c;var k=a.vectors.items[c].texCoords[1],n=a.vectors.items[f].texCoords[1];for(c=0;c<D.count;++c){var t=d*(1-Math.abs(D.count/2-c)/(D.count/2)),v=k+c/(D.count-1)*(n-k),A=D.items[c],m=a.vectors.items[h+c];m.vector[0]=A[0];m.vector[1]=A[1];m.texCoords[0]=t;m.texCoords[1]=v;b.items[c+1]=h+c}b.items[D.count+1]=f;b.count=D.count+2;a.vectors.count=h+D.count};var O=
Math.cos(Math.PI/4),P=Math.sin(Math.PI/4),V=Math.sqrt(2);a.squareCap=function(a,b,c,f){y(a,b,c);b=f===r.START?0:1;c=f===r.START?1:0;var d=n[0],k=n[1],t=n[2],v=n[3];f=n[4];var p=a.vectors.items[b].vector;d[0]=O*p[0]-P*p[1];d[1]=P*p[0]+O*p[1];h(v,d,V);k[0]=O*d[0]-P*d[1];k[1]=P*d[0]+O*d[1];t[0]=O*k[0]-P*k[1];t[1]=P*k[0]+O*k[1];h(f,t,V);b=a.vectors.items[b];b.vector[0]=v[0];b.vector[1]=v[1];a=a.vectors.items[c];a.vector[0]=f[0];a.vector[1]=f[1]};a.fastMiterJoin=y;a.miterJoin=function(a,b,f){b=m(n[0],
b);f=m(n[1],f);var d=n[2];d[0]=b[0]+f[0];d[1]=b[1]+f[1];f=q(n[3],d);b=E(f,b);f=h(n[4],f,1/b);b=c(n[5],f);d=a.vectors.items[0];d.vector[0]=f[0];d.vector[1]=f[1];d.texCoords[0]=C;d.texCoords[1]=G;f=a.vectors.items[1];f.vector[0]=b[0];f.vector[1]=b[1];f.texCoords[0]=C;f.texCoords[1]=H;a.vectors.count=2;b=a.lists[p.ENTRY];b.items[0]=0;b.items[1]=1;b.count=2;b=a.lists[p.EXIT];b.items[0]=0;b.items[1]=1;b.count=2;a.lists[p.CAP].count=0;a.capCenter=void 0};a.bevelJoin=function(a,d,k,r){var t=r*r;r=b(d,k);
var l=0<r?[G,H]:[H,G],v=l[0],l=l[1],w=0<r?c(n[0],m(n[1],d)):m(n[2],d),D=0<r?c(n[3],m(n[4],k)):m(n[5],k),y=n[6];y[0]=w[0]+D[0];y[1]=w[1]+D[1];var y=q(n[7],y),F=c(n[8],y),K=E(y,w),x=b(y,w),J=Math.abs(x/K),O=1+J*J,I=B>O?[J,!1]:[Math.sqrt(B-1),!0],x=I[0],I=I[1],J=t>O?[J,!1]:[Math.sqrt(t-1),!0],t=J[0];(J=J[1])&&I?(I=a.vectors.items[0],f(I.vector,c(n[9],w),h(n[10],c(n[11],d),x)),I.texCoords[0]=C,I.texCoords[1]=v,F=a.vectors.items[1],f(F.vector,c(n[12],D),h(n[13],k,x)),F.texCoords[0]=C,F.texCoords[1]=v,
v=a.vectors.items[2],v.vector[0]=0,v.vector[1]=0,v.texCoords[0]=C,v.texCoords[1]=C,v=a.vectors.items[3],f(v.vector,w,h(n[14],d,t)),v.texCoords[0]=C,v.texCoords[1]=l,d=a.vectors.items[4],f(d.vector,D,h(n[15],c(n[16],k),t)),d.texCoords[0]=C,d.texCoords[1]=l,a.vectors.count=5,k=a.lists[p.ENTRY],k.items[0]=0,k.items[1]=2,k.items[2]=3,k.count=3,k=a.lists[p.EXIT],k.items[0]=1,k.items[1]=2,k.items[2]=4,k.count=3,k=a.lists[p.CAP],k.items[0]=3,k.items[1]=4,k.count=2,a.capCenter=2):!J&&I?(I=a.vectors.items[0],
f(I.vector,c(n[9],w),h(n[10],c(n[11],d),x)),I.texCoords[0]=C,I.texCoords[1]=v,F=a.vectors.items[1],f(F.vector,c(n[12],D),h(n[13],k,x)),F.texCoords[0]=C,F.texCoords[1]=v,v=a.vectors.items[2],v.vector[0]=0,v.vector[1]=0,v.texCoords[0]=C,v.texCoords[1]=C,v=a.vectors.items[3],h(v.vector,y,1/K),v.texCoords[0]=C,v.texCoords[1]=l,a.vectors.count=4,k=a.lists[p.ENTRY],k.items[0]=0,k.items[1]=2,k.items[2]=3,k.count=3,k=a.lists[p.EXIT],k.items[0]=1,k.items[1]=2,k.items[2]=3,k.count=3,a.lists[p.CAP].count=0,
a.capCenter=void 0):J&&!I?(I=a.vectors.items[0],h(I.vector,F,1/K),I.texCoords[0]=C,I.texCoords[1]=v,F=a.vectors.items[1],F.vector[0]=0,F.vector[1]=0,F.texCoords[0]=C,F.texCoords[1]=C,v=a.vectors.items[2],f(v.vector,w,h(n[9],d,t)),v.texCoords[0]=C,v.texCoords[1]=l,v=a.vectors.items[3],f(v.vector,D,h(n[10],c(n[11],k),t)),v.texCoords[0]=C,v.texCoords[1]=l,a.vectors.count=4,k=a.lists[p.ENTRY],k.items[0]=0,k.items[1]=1,k.items[2]=2,k.count=3,k=a.lists[p.EXIT],k.items[0]=0,k.items[1]=1,k.items[2]=3,k.count=
3,k=a.lists[p.CAP],k.items[0]=2,k.items[1]=3,k.count=2,a.capCenter=1):J||I||(I=a.vectors.items[0],h(I.vector,F,1/K),I.texCoords[0]=C,I.texCoords[1]=v,F=a.vectors.items[1],h(F.vector,y,1/K),F.texCoords[0]=C,F.texCoords[1]=l,a.vectors.count=2,k=a.lists[p.ENTRY],k.items[0]=0,k.items[1]=1,k.count=2,k=a.lists[p.EXIT],k.items[0]=0,k.items[1]=1,k.count=2,a.lists[p.CAP].count=0,a.capCenter=void 0);0>r&&(A(a.lists[p.ENTRY]),A(a.lists[p.EXIT]))};a.roundJoin=function(a,d,k,r){var t=b(d,k),v=0<t?[G,H]:[H,G],
w=v[0],v=v[1],y=0<t?c(n[0],m(n[1],d)):m(n[2],d),F=0<t?c(n[3],m(n[4],k)):m(n[5],k),K=n[6];K[0]=y[0]+F[0];K[1]=y[1]+F[1];var I=q(n[7],K),K=c(n[8],I),x=E(I,y),I=b(I,y),I=Math.abs(I/x),J=B>1+I*I?[I,!1]:[Math.sqrt(B-1),!0],I=J[0];J[1]?(J=a.vectors.items[0],J.vector[0]=y[0],J.vector[1]=y[1],J.texCoords[0]=C,J.texCoords[1]=v,J=a.vectors.items[1],J.vector[0]=F[0],J.vector[1]=F[1],J.texCoords[0]=C,J.texCoords[1]=v,J=a.vectors.items[2],f(J.vector,c(n[9],y),h(n[10],c(n[11],d),I)),J.texCoords[0]=C,J.texCoords[1]=
w,d=a.vectors.items[3],f(d.vector,c(n[12],F),h(n[13],k,I)),d.texCoords[0]=C,d.texCoords[1]=w,k=a.vectors.items[4],k.vector[0]=0,k.vector[1]=0,k.texCoords[0]=C,k.texCoords[1]=C,a.vectors.count=5,k=a.lists[p.ENTRY],k.items[0]=2,k.items[1]=4,k.items[2]=0,k.count=3,k=a.lists[p.EXIT],k.items[0]=3,k.items[1]=4,k.items[2]=1,k.count=3,a.capCenter=4):(J=a.vectors.items[0],J.vector[0]=y[0],J.vector[1]=y[1],J.texCoords[0]=C,J.texCoords[1]=v,J=a.vectors.items[1],J.vector[0]=F[0],J.vector[1]=F[1],J.texCoords[0]=
C,J.texCoords[1]=v,J=a.vectors.items[2],h(J.vector,K,1/x),J.texCoords[0]=C,J.texCoords[1]=w,d=a.vectors.items[3],d.vector[0]=0,d.vector[1]=0,d.texCoords[0]=C,d.texCoords[1]=C,a.vectors.count=4,k=a.lists[p.ENTRY],k.items[0]=2,k.items[1]=3,k.items[2]=0,k.count=3,k=a.lists[p.EXIT],k.items[0]=2,k.items[1]=3,k.items[2]=1,k.count=3,a.capCenter=3);l(D,y,F,r,0>t);r=a.vectors.count;y=a.lists[p.CAP];for(F=y.items[0]=0;F<D.count;++F)k=D.items[F],w=a.vectors.items[r+F],w.vector[0]=k[0],w.vector[1]=k[1],w.texCoords[0]=
C,w.texCoords[1]=v,y.items[F+1]=r+F;y.items[D.count+1]=1;y.count=D.count+2;a.vectors.count=r+D.count;0>t&&(A(a.lists[p.ENTRY]),A(a.lists[p.EXIT]))};a.unitRoundJoin=function(a,f,d,k){var h=b(f,d),r=0<h?[G,H]:[H,G],w=r[0],r=r[1];f=0<h?c(n[0],m(n[1],f)):m(n[2],f);d=0<h?c(n[3],m(n[4],d)):m(n[5],d);var t=a.vectors.items[0];t.vector[0]=f[0];t.vector[1]=f[1];t.texCoords[0]=C;t.texCoords[1]=r;t=a.vectors.items[1];t.vector[0]=d[0];t.vector[1]=d[1];t.texCoords[0]=C;t.texCoords[1]=r;t=a.vectors.items[2];c(t.vector,
f);t.texCoords[0]=C;t.texCoords[1]=w;t=a.vectors.items[3];c(t.vector,d);t.texCoords[0]=C;t.texCoords[1]=w;w=a.vectors.items[4];w.vector[0]=0;w.vector[1]=0;w.texCoords[0]=C;w.texCoords[1]=C;a.vectors.count=5;w=a.lists[p.ENTRY];w.items[0]=2;w.items[1]=0;w.count=2;w=a.lists[p.EXIT];w.items[0]=3;w.items[1]=1;w.count=2;a.capCenter=4;l(D,f,d,k,0>h);k=a.vectors.count;f=a.lists[p.CAP];for(w=f.items[0]=0;w<D.count;++w)d=D.items[w],t=a.vectors.items[k+w],t.vector[0]=d[0],t.vector[1]=d[1],t.texCoords[0]=C,t.texCoords[1]=
r,f.items[w+1]=k+w;f.items[D.count+1]=1;f.count=D.count+2;a.vectors.count=k+D.count;0>h&&(A(a.lists[p.ENTRY]),A(a.lists[p.EXIT]))};a.rectJoin=function(a,b,f){b=m(n[0],b);f=m(n[1],f);var d=a.vectors.items[0];d.vector[0]=b[0];d.vector[1]=b[1];d.texCoords[0]=C;d.texCoords[1]=G;d=a.vectors.items[1];d.vector[0]=f[0];d.vector[1]=f[1];d.texCoords[0]=C;d.texCoords[1]=G;d=a.vectors.items[2];c(d.vector,b);d.texCoords[0]=C;d.texCoords[1]=H;b=a.vectors.items[3];c(b.vector,f);b.texCoords[0]=C;b.texCoords[1]=H;
a.vectors.count=4;b=a.lists[p.ENTRY];b.items[0]=0;b.items[1]=2;b.count=2;b=a.lists[p.EXIT];b.items[0]=1;b.items[1]=3;b.count=2;a.capCenter=void 0}})},"esri/views/vectorTiles/SymbolBucket":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper ./Bucket ./Geometry ./style/StyleLayer ./Placement ./GeometryUtils ./TextShaping dojox/string/BidiEngine".split(" "),function(z,a,d,E,x,q,m,b,c,h,f){function k(a,b){return a.iconMosaicItem&&b.iconMosaicItem?
a.iconMosaicItem.page===b.iconMosaicItem.page?0:a.iconMosaicItem.page<b.iconMosaicItem.page?-1:1:a.iconMosaicItem&&!b.iconMosaicItem?1:!a.iconMosaicItem&&b.iconMosaicItem?-1:0}var l=function(){return function(){}}(),A=function(){return function(a,b,c,f){this.line=b;this.shaping=a;this.iconMosaicItem=c;this.anchor=f}}();z=(function(){return function(){}}(),function(a){function f(b,c,f,d,k,h,n,l){b=a.call(this,b,c)||this;return b._markerRatio=1,b._markerMap=new Map,b._glyphMap=new Map,b._glyphBufferDataStorage=
new Map,b._markerVertexBuffer=f,b._markerIndexBuffer=d,b._textVertexBuffer=k,b._textIndexBuffer=h,b._placementEngine=n,b._workerTileHandler=l,b}return d(f,a),Object.defineProperty(f.prototype,"markerPageMap",{get:function(){return this._markerMap},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"glyphsPageMap",{get:function(){return this._glyphMap},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"textIndexStart",{get:function(){return this._textTriangleElementsStart},
enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"textIndexCount",{get:function(){return this._textTriangleElementsNum},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"sdfMarker",{get:function(){return!1},enumerable:!0,configurable:!0}),f.prototype.copy=function(a,b,c,d,k){k=new f(this.layer,this.zoom,a,b,c,d,k,this._workerTileHandler);return k.layerIndex=this.layerIndex,k.layerExtent=this.layerExtent,k._markerVertexStart=a.index,k._markerTriangleElementsStart=
b.index,k._textVertexStart=c.index,k._textTriangleElementsStart=d.index,k._markerTriangleElementsNum=0,k._textTriangleElementsNum=0,k._symbolInstances=this._symbolInstances,k._workerTileHandler=this._workerTileHandler,k._font=this._font,k._textLayout=this._textLayout,k._markerLayout=this._markerLayout,k._isLinePlacement=this._isLinePlacement,k._avoidEdges=this._avoidEdges,k},f.prototype.getResources=function(a,b,c){var d=this.layer,k=this.zoom;a&&a.setExtent(this.layerExtent);for(var h=d.getLayoutValue("icon-image",
k),n=d.getLayoutValue("text-field",k),r=d.getLayoutValue("text-font",k),d=d.getLayoutValue("text-transform",k),k=[],m=0,A=this._features;m<A.length;m++){var p=A[m],y=p.getGeometry(a);if(y&&0!==y.length){var B=void 0;h&&(B=this._replaceKeys(h,p.values),B&&b.add(B));var v=void 0,G=!1;if(n){switch(v=this._replaceKeys(n,p.values),d){case 2:v=v.toLowerCase();break;case 1:v=v.toUpperCase()}f._bidiEngine.hasBidiChar(v)&&(G=void 0,G="rtl"===f._bidiEngine.checkContextual(v)?"IDNNN":"ICNNN",v=f._bidiEngine.bidiTransform(v,
G,"VLYSN"),G=!0);p=v.length;if(0<p){var t=c[r];t||(t=c[r]=new Set);for(var q=0;p>q;q++){var x=v.charCodeAt(q);t.add(x)}}}if(B||v)p=new l,p.sprite=B,p.label=v,p.rtl=G,p.geometry=y,k.push(p)}}this._symbolFeatures=k},f.prototype.processFeatures=function(a,d){a&&a.setExtent(this.layerExtent);var r,l=this.layer,p=this.zoom;d=this._isLinePlacement=1===l.getLayoutValue("symbol-placement",p);a=this._avoidEdges=l.getLayoutValue("symbol-avoid-edges",p)&&!d;var w=8*l.getLayoutValue("symbol-spacing",p),n=l.getLayoutValue("icon-image",
p),y=l.getLayoutValue("text-field",p),B=this._workerTileHandler;n&&(this._markerLayout=new m.IconLayout(l,p,d),r=B.getSpriteItems());var q,x;if(y){var E=this._textLayout=new m.TextLayout(l,p,d);q=void 0;E.font&&E.font.length&&(q=E.font[0],this._font=q);x=.5;switch(E.anchor){case 5:case 1:case 7:x=0;break;case 6:case 2:case 8:x=1}l=.5;switch(E.anchor){case 5:case 3:case 6:l=0;break;case 7:case 4:case 8:l=1}p=.5;switch(E.justify){case 0:p=0;break;case 2:p=1}var n=24*E.letterSpacing,y=d?0:24*E.maxWidth,
z=24*E.lineHeight,E=[24*E.offset[0],24*E.offset[1]];q=B.getGlyphItems(q);x=new h(q,y,z,n,E,x,l,p)}this._markerVertexStart=this._markerVertexBuffer.index;this._markerTriangleElementsStart=this._markerIndexBuffer.index;this._textVertexStart=this._textVertexBuffer.index;this._textTriangleElementsStart=this._textIndexBuffer.index;this._textTriangleElementsNum=this._markerTriangleElementsNum=0;this._markerMap.clear();this._glyphMap.clear();this._symbolInstances=B=[];l=this._textLayout;p=1;l&&l.size&&(p=
l.size/24);n=l?l.maxAngle*c.C_DEG_TO_RAD:0;y=l?8*l.size:0;z=0;for(E=this._symbolFeatures;z<E.length;z++){var v=E[z],F=void 0;v.sprite&&(F=r[v.sprite]);var t=void 0,J=v.label,T=0;if(J&&(t=x.getShaping(J,v.rtl),t&&0<t.length)){for(var T=1E30,J=-1E30,aa=0,L=t;aa<L.length;aa++)var R=L[aa],T=Math.min(T,R.x),J=Math.max(J,R.x);T=(J-T+48)*p*8}J=0;for(v=v.geometry;J<v.length;J++)for(aa=v[J],R=void 0,d?(t&&0<t.length&&l&&l.size&&f._smoothVertices(aa,8*l.size*(2+Math.min(2,4*Math.abs(l.offset[1])))),R=f._findAnchors(aa,
w,T)):R=[new b.Anchor(aa[0].x,aa[0].y)],L=0;L<R.length;L++){var Q=R[L];0>Q.x||4096<Q.x||0>Q.y||4096<Q.y||d&&0<T&&0===l.rotationAlignment&&!f._honorsTextMaxAngle(aa,Q,T,n,y)||B.push(new A(t,aa,F,Q))}}B.sort(k);for(r=0;r<B.length;r++)this._processFeature(B[r],q,a);this._addPlacedGlyphs()},f.prototype.updateSymbols=function(){this._markerVertexStart=this._markerVertexBuffer.index;this._markerTriangleElementsStart=this._markerIndexBuffer.index;this._textVertexStart=this._textVertexBuffer.index;this._textTriangleElementsStart=
this._textIndexBuffer.index;this._textTriangleElementsNum=this._markerTriangleElementsNum=0;this._markerMap.clear();this._glyphMap.clear();for(var a=this._workerTileHandler.getGlyphItems(this._font),b=this._avoidEdges,c=0,f=this._symbolInstances;c<f.length;c++)this._processFeature(f[c],a,b);this._addPlacedGlyphs()},f.prototype._replaceKeys=function(a,b){return a.replace(/{([^{}]+)}/g,function(a,c){return c in b?b[c]:""})},f.prototype._processFeature=function(a,b,f){var d=a.line,k=a.iconMosaicItem,
h=a.shaping,n=a.anchor,l=(a=this._markerLayout)&&!!k,r=!0,m=1;l&&(m=a.size/(1/this._markerRatio)*8,r=a.optional||!k);var p=this._textLayout,A=p&&h&&0<h.length,y=1,v=y,B=!0;A&&(y=p.size/24,v=8*y,B=p.optional||!h||0===h.length);var t,y=new q.Point(0,-17);if(l){if(t=this._placementEngine.getIconPlacement(n,k,m,d,a,f),t.footprint.minzoom===c.C_INFINITY&&!r)return;n.minzoom>t.footprint.minzoom&&(t.footprint.minzoom=n.minzoom)}var G;if(A&&(G=this._placementEngine.getTextPlacement(n,y,h,b,v,d,p,f))){if(G.footprint.minzoom===
c.C_INFINITY&&!B)return;n.minzoom>G.footprint.minzoom&&(G.footprint.minzoom=n.minzoom)}if(!B&&!r||!r&&G&&G.footprint.minzoom!==c.C_INFINITY||!B&&t&&t.footprint.minzoom!==c.C_INFINITY)b=Math.max(t.footprint.minzoom,G.footprint.minzoom),t.footprint.minzoom=b,G.footprint.minzoom=b;G&&G.footprint.minzoom!==c.C_INFINITY&&(p.ignorePlacement||this._placementEngine.add(G),this._storePlacedGlyphs(G.shapes,G.footprint.minzoom,this.zoom));t&&t.footprint.minzoom!==c.C_INFINITY&&(a.ignorePlacement||this._placementEngine.add(t),
this._addPlacedIcons(t.shapes,t.footprint.minzoom,this.zoom,k.page))},f.prototype._addPlacedIcons=function(a,b,f,d){b=Math.max(f+c.log2(b),0);for(var k=this._markerVertexBuffer,h=this._markerIndexBuffer,n=0;n<a.length;n++){var l=a[n],r=Math.max(f+c.log2(l.minzoom),b),p=Math.min(f+c.log2(l.maxzoom),25);if(!(r>=p)){var m=l.tl,A=l.tr,y=l.bl,v=l.br,B=l.mosaicRect,t=-l.labelAngle,l=l.anchor,q=k.index,G=B.x,H=B.y,x=G+B.width,B=H+B.height;k.add(l.x,l.y,m.x,m.y,G,H,t,r,p,b);k.add(l.x,l.y,A.x,A.y,x,H,t,r,
p,b);k.add(l.x,l.y,y.x,y.y,G,B,t,r,p,b);k.add(l.x,l.y,v.x,v.y,x,B,t,r,p,b);h.add(q+0,q+1,q+2);h.add(q+1,q+2,q+3);this._markerMap.has(d)?this._markerMap.get(d)[1]+=6:this._markerMap.set(d,[this._markerTriangleElementsStart+this._markerTriangleElementsNum/3,6]);this._markerTriangleElementsNum+=6}}},f.prototype._addPlacedGlyphs=function(){var a=this,b=this._textVertexBuffer,c=this._textIndexBuffer;this._glyphBufferDataStorage.forEach(function(f,d){for(var k=0;k<f.length;k++){var h=f[k],l=b.index;b.add(h.glyphAnchor[0],
h.glyphAnchor[1],h.tl[0],h.tl[1],h.xmin,h.ymin,h.labelAngle,h.minLod,h.maxLod,h.placementLod);b.add(h.glyphAnchor[0],h.glyphAnchor[1],h.tr[0],h.tr[1],h.xmax,h.ymin,h.labelAngle,h.minLod,h.maxLod,h.placementLod);b.add(h.glyphAnchor[0],h.glyphAnchor[1],h.bl[0],h.bl[1],h.xmin,h.ymax,h.labelAngle,h.minLod,h.maxLod,h.placementLod);b.add(h.glyphAnchor[0],h.glyphAnchor[1],h.br[0],h.br[1],h.xmax,h.ymax,h.labelAngle,h.minLod,h.maxLod,h.placementLod);c.add(l+0,l+1,l+2);c.add(l+1,l+2,l+3);a._glyphMap.has(d)?
a._glyphMap.get(d)[1]+=6:a._glyphMap.set(d,[a._textTriangleElementsStart+a._textTriangleElementsNum/3,6]);a._textTriangleElementsNum+=6}});this._glyphBufferDataStorage.clear()},f.prototype._storePlacedGlyphs=function(a,b,f){b=Math.max(f+c.log2(b),0);for(var d=0;d<a.length;d++){var h=a[d],k=Math.max(f+c.log2(h.minzoom),b),l=Math.min(f+c.log2(h.maxzoom),25);if(!(k>=l)){var r=h.tl,p=h.tr,m=h.bl,A=h.br,y=-h.labelAngle,B=h.anchor,v=h.mosaicRect;this._glyphBufferDataStorage.has(h.page)||this._glyphBufferDataStorage.set(h.page,
[]);this._glyphBufferDataStorage.get(h.page).push({glyphAnchor:[B.x,B.y],tl:[r.x,r.y],tr:[p.x,p.y],bl:[m.x,m.y],br:[A.x,A.y],xmin:v.x,ymin:v.y,xmax:v.x+v.width,ymax:v.y+v.height,labelAngle:y,minLod:k,maxLod:l,placementLod:b})}}},f._findAnchors=function(a,f,h){f+=h;for(var d=0,k=a.length-1,l=0;k>l;l++)d+=q.Point.distance(a[l],a[l+1]);l=h||f;if(l*=.5,l>=d)return[];h=l/d;f=d/Math.max(Math.round(d/f),1);for(var d=0,k=-f/2,n=[],p=a.length-1,l=0;p>l;l++){for(var m=a[l],r=a[l+1],A=r.x-m.x,y=r.y-m.y,B=Math.sqrt(A*
A+y*y),v=void 0;d+B>k+f;){var k=k+f,G=(k-d)/B,t=c.interpolate(m.x,r.x,G),G=c.interpolate(m.y,r.y,G);void 0===v&&(v=Math.atan2(y,A));n.push(new b.Anchor(t,G,v,l,h))}d+=B}return n},f.deviation=function(a,b,c){return Math.atan2((b.x-a.x)*(c.y-b.y)-(b.y-a.y)*(c.x-b.x),(b.x-a.x)*(c.x-b.x)+(b.y-a.y)*(c.y-b.y))},f._honorsTextMaxAngle=function(a,b,c,f,h){var d=0;c/=2;for(var k=new q.Point(b.x,b.y),l=b.segment+1;d>-c;){if(--l,0>l)return!1;d-=q.Point.distance(a[l],k);k=a[l]}d+=q.Point.distance(a[l],a[l+1]);
b=[];for(var k=0,p=a.length;c>d;){var m=a[l],A=void 0;do{if(++l,l===p)return!1;A=a[l]}while(A.isEqual(m));var r=l,y=void 0;do{if(++r,r===p)return!1;y=a[r]}while(y.isEqual(A));m=this.deviation(m,A,y);b.push({deviation:m,distToAnchor:d});for(k+=m;d-b[0].distToAnchor>h;)k-=b.shift().deviation;if(Math.abs(k)>f)return!1;d+=q.Point.distance(A,y)}return!0},f._smoothVertices=function(a,b){if(!(0>=b)){var c=a.length;if(!(3>c)){var f=[],d=0;f.push(0);for(var h=1;c>h;h++)d+=q.Point.distance(a[h],a[h-1]),f.push(d);
b=Math.min(b,.2*d);d=[];d.push(a[0].x);d.push(a[0].y);var k=a[c-1].x,l=a[c-1].y,h=q.Point.sub(a[0],a[1]);h.normalize();a[0].x+=b*h.x;a[0].y+=b*h.y;h.assignSub(a[c-1],a[c-2]);h.normalize();a[c-1].x+=b*h.x;a[c-1].y+=b*h.y;for(h=1;c>h;h++)f[h]+=b;f[c-1]+=b;for(var m=.5*b,h=1;c-1>h;h++){for(var p=0,A=0,y=0,r=h-1;0<=r&&!(f[r+1]<f[h]-m);r--){var v=m+f[r+1]-f[h],B=f[r+1]-f[r],t=f[h]-f[r]<m?1:v/B;if(1E-6>Math.abs(t))break;var x=t*t,E=t*v-.5*x*B,z=t*B/b,L=a[r+1],R=a[r].x-L.x,Q=a[r].y-L.y,p=p+z/E*(L.x*t*v+
.5*x*(v*R-B*L.x)-x*t*B*R/3),A=A+z/E*(L.y*t*v+.5*x*(v*Q-B*L.y)-x*t*B*Q/3),y=y+z}for(r=h+1;c>r&&!(f[r-1]>f[h]+m);r++){v=m-f[r-1]+f[h];B=f[r]-f[r-1];t=f[r]-f[h]<m?1:v/B;if(1E-6>Math.abs(t))break;x=t*t;E=t*v-.5*x*B;z=t*B/b;L=a[r-1];R=a[r].x-L.x;Q=a[r].y-L.y;p+=z/E*(L.x*t*v+.5*x*(v*R-B*L.x)-x*t*B*R/3);A+=z/E*(L.y*t*v+.5*x*(v*Q-B*L.y)-x*t*B*Q/3);y+=z}d.push(p/y);d.push(A/y)}d.push(k);d.push(l);for(r=h=0;c>h;h++)a[h].x=d[r++],a[h].y=d[r++]}}},f}(x));return z._bidiEngine=new f,z})},"esri/views/vectorTiles/Placement":function(){define(["require",
"exports","./Geometry","./GeometryUtils","./Conflict"],function(z,a,d,E,x){Object.defineProperty(a,"__esModule",{value:!0});z=function(){return function(a,b,d,l,m){void 0===d&&(d=0);void 0===l&&(l=-1);void 0===m&&(m=c);this.x=a;this.y=b;this.angle=d;this.segment=l;this.minzoom=m}}();a.Anchor=z;z=function(){return function(a,b,c){this.glyph=a;this.x=b;this.y=c}}();a.ShapedGlyph=z;var q=function(){return function(a,b,d,l,m,y,p){void 0===m&&(m=!1);void 0===y&&(y=c);void 0===p&&(p=E.C_INFINITY);this.anchor=
a;this.labelAngle=b;this.glyphAngle=d;this.page=l;this.upsideDown=m;this.minzoom=y;this.maxzoom=p}}(),m=function(){return function(a,b,c,d,m,y,p,r,q,x){this.tl=a;this.tr=b;this.bl=c;this.br=d;this.mosaicRect=m;this.labelAngle=y;this.anchor=p;this.minzoom=r;this.maxzoom=q;this.page=x}}();a.PlacedSymbol=m;var b=function(){return function(a,b){this.footprint=a;this.shapes=b}}();a.Placement=b;var c=.5;z=function(){function a(){this.mapAngle=0;this._conflictEngine=new x.ConflictEngine}return a.prototype.reset=
function(){this._conflictEngine.reset()},a.prototype.setAngle=function(a){this.mapAngle=a;this._conflictEngine.setAngle(a)},a.prototype.getIconPlacement=function(a,h,l,A,y,p){var f=h.width/h.pixelRatio,k=h.height/h.pixelRatio;A=y.offset[0]-f/2;var q=y.offset[1]-k/2,f=A+f,k=q+k,H=h.rect,C=A-2,w=q-2,n=C+H.width/h.pixelRatio,D=w+H.height/h.pixelRatio;h=new d.Point(C,w);var z=new d.Point(n,D),C=new d.Point(C,D),n=new d.Point(n,w),D=y.rotate*E.C_DEG_TO_RAD,w=1===y.rotationAlignment;if(0<=a.segment&&!w&&
(D+=a.angle),0!==D){var I=Math.cos(D),O=Math.sin(D);h.rotate(I,O);z.rotate(I,O);C.rotate(I,O);n.rotate(I,O)}I=8*y.padding;O=new d.Point(a.x,a.y);a=new x.Footprint(this.mapAngle,I,w);a.addBox(O,new x.Box(A,q,f,k),l,D,c,E.C_INFINITY);l=new m(h,n,C,z,H,0,O,c,E.C_INFINITY,0);l=new b(a,[l]);A=c;return y.allowOverlap||(A=this._conflictEngine.getMinZoom(l.footprint,A,p,w)),a.minzoom=A,l},a.prototype.getTextPlacement=function(a,h,l,A,y,p,r,B){for(var f,k=new d.Point(a.x,a.y),C=r.rotate*E.C_DEG_TO_RAD,w=0===
r.rotationAlignment,n=r.keepUpright,D=c,z=!w,I=z?0:a.angle,O=0<=a.segment&&w,P=new x.Footprint(this.mapAngle,8*r.padding,z),V=[],v=!O,F=Number.POSITIVE_INFINITY,t=Number.NEGATIVE_INFINITY,J=F,T=t,aa=O?n:w&&n,L=[],R=0;R<l.length;R++){var Q=l[R],W=A[Q.glyph];if(W&&!W.rect.isEmpty){var ja=W.rect,ea=W.metrics,ca=W.page;v&&(f&&f!==Q.y&&(P.addBox(k,new x.Box(F,J,t,T),y,C,c,E.C_INFINITY),F=Number.POSITIVE_INFINITY,t=Number.NEGATIVE_INFINITY,J=F,T=t),f=Q.y);var fa=[];if(O){if(W=(h.x+Q.x+ea.left-4+.5*W.metrics.width)*
y,D=this._placeGlyph(a,D,W,p,a.segment,1,ca,fa),n&&(D=this._placeGlyph(a,D,W,p,a.segment,-1,ca,fa)),2<=D)break}else fa.push(new q(k,I,I,ca)),w&&n&&fa.push(new q(k,I+E.C_PI,I+E.C_PI,ca,!0));for(var ca=Q.x+h.x+ea.left,Q=Q.y+h.y-ea.top,W=ca+ea.width,ea=Q+ea.height,da=new d.Point(ca-4,Q-4),X=new d.Point(da.x+ja.width,da.y+ja.height),ga=new d.Point(da.x,X.y),U=new d.Point(X.x,da.y),ha=0;ha<fa.length;ha++){var Y=fa[ha],ka=da.clone(),la=ga.clone(),ma=U.clone(),na=X.clone(),oa=Q,ba=ea,M=Y.glyphAngle+C;if(0!==
M){var S=Math.cos(M),e=Math.sin(M);ka.rotate(S,e);na.rotate(S,e);la.rotate(S,e);ma.rotate(S,e)}V.push(new m(ka,ma,la,na,ja,Y.labelAngle,Y.anchor,Y.minzoom,Y.maxzoom,Y.page));(!aa||this._legible(Y.labelAngle))&&(v?(F>ca&&(F=ca),J>oa&&(J=oa),W>t&&(t=W),ba>T&&(T=ba)):2>Y.minzoom&&P.addBox(Y.anchor,new x.Box(ca,oa,W,ba),y,M,Y.minzoom,Y.maxzoom));L.push(Y)}}}if(2<=D)return null;v&&P.addBox(k,new x.Box(F,J,t,T),y,C,c,E.C_INFINITY);a=new b(P,V);return r.allowOverlap||(D=this._conflictEngine.getMinZoom(a.footprint,
D,B,z)),P.minzoom=D,a},a.prototype.add=function(a){this._conflictEngine.add(a.footprint)},a.prototype._legible=function(a){a=E.radToByte(a);return 65>a||193<=a},a.prototype._placeGlyph=function(a,b,c,h,m,p,r,B){var f=0>p?E.positiveMod(a.angle+E.C_PI,E.C_2PI):a.angle,k=this._legible(f),l=0;0>c&&(p*=-1,c*=-1,l=E.C_PI);0<p&&++m;a=new d.Point(a.x,a.y);var A=h[m],n=E.C_INFINITY;if(h.length<=m)return n;for(;;){var y=A.x-a.x,x=A.y-a.y,z=Math.sqrt(y*y+x*x),O=Math.max(c/z,b),y=E.positiveMod(Math.atan2(x/z,
y/z)+l,E.C_2PI);if(B.push(new q(a,f,y,r,k,O,n)),b>=O)return O;a=A.clone();do{if(m+=p,h.length<=m||0>m)return O;A=h[m]}while(a.isEqual(A));n=A.x-a.x;y=A.y-a.y;x=Math.sqrt(n*n+y*y);n*=z/x;y*=z/x;a.x-=n;a.y-=y;n=O}},a}();a.PlacementEngine=z})},"esri/views/vectorTiles/Conflict":function(){define(["require","exports","./Geometry","./GeometryUtils"],function(z,a,d,E){Object.defineProperty(a,"__esModule",{value:!0});z=function(){function a(a,c,h,f){this.left=a;this.top=c;this.right=h;this.bottom=f}return a.prototype.clone=
function(){return new a(this.left,this.top,this.right,this.bottom)},a.prototype.move=function(a,c){this.left+=a;this.top+=c;this.right+=a;this.bottom+=c},a.prototype.rotate=function(a,c){var b=this.left,f=this.right,d=this.top,l=this.bottom,m=b*a-d*c,y=b*c+d*a,p=f*a-d*c,d=f*c+d*a,r=b*a-l*c,b=b*c+l*a,q=f*a-l*c;a=f*c+l*a;this.left=Math.min(m,p,r,q);this.top=Math.min(y,d,b,a);this.right=Math.max(m,p,r,q);this.bottom=Math.max(y,d,b,a)},a.overlaps=function(a,c){return a.right>c.left&&a.left<c.right&&a.bottom>
c.top&&a.top<c.bottom},a}();a.Box=z;var x=function(){function a(a,c,d,f){this.anchor=a;this.corners=c;this.minzoom=d;this.maxzoom=f}return a.prototype.left=function(){return this.corners[0].x},a.prototype.right=function(){return this.corners[2].x},a.prototype.top=function(){return this.corners[1].y},a.prototype.bottom=function(){return this.corners[3].y},a}();a.Obstacle=x;z=function(){function a(a,c,d){this.obstacles=[];this.mapAngle=a;this.padding=c;this.isScreenAligned=d;this.minzoom=q}return a.prototype.addBox=
function(a,c,h,f,k,l){var b=c.left*h-this.padding,m=c.top*h-this.padding,p=c.right*h+this.padding;c=c.bottom*h+this.padding;b=[new d.Point(b,m),new d.Point(p,m),new d.Point(p,c),new d.Point(b,c)];0!==this.mapAngle&&(m=Math.cos(this.mapAngle),p=Math.sin(this.mapAngle),a=a.clone(),a.rotate(m,p));if(this.isScreenAligned||(f+=this.mapAngle),0!==f){m=Math.cos(f);p=Math.sin(f);b[0].rotate(m,p);b[1].rotate(m,p);b[2].rotate(m,p);b[3].rotate(m,p);f=0;for(m=1;4>m;m++)b[m].x<b[f].x?f=m:b[m].x===b[f].x&&b[m].y<
b[f].y&&(f=m);if(f){p=[];for(m=0;4>m;m++)p.push(b[(m+f)%4]);b=p}}this.obstacles.push(new x(a,b,k,l))},a}();a.Footprint=z;var q=.5;z=function(){function a(){this._grid=[]}return a.prototype.setAngle=function(a){this._angle=a;this._c=Math.cos(a);this._s=Math.sin(a)},a.prototype.reset=function(){this._angle=this._s=0;this._c=1;this._grid=[]},a.prototype.add=function(b){var c=this._grid,d=0;for(b=b.obstacles;d<b.length;d++)for(var f=b[d],k=f.anchor,l=a._gridClamp(Math.min(f.left()+k.x,k.x)),m=a._gridClamp(Math.max(f.right()+
k.x,k.x)),y=a._gridClamp(Math.min(f.top()+k.y,k.y)),k=a._gridClamp(Math.max(f.bottom()+k.y,k.y));k>=y;y++)for(var p=l;m>=p;p++){var r=c[16*y+p];r||(r=c[16*y+p]=[]);r.push(f)}},a.prototype.getMinZoom=function(b,c,d,f){if(0===b.obstacles.length)return E.C_INFINITY;d=this._grid;f=0;for(b=b.obstacles;f<b.length;f++)for(var h=b[f],l=h.anchor,m=a._gridClamp(Math.min(h.left()+l.x,l.x)),y=a._gridClamp(Math.max(h.right()+l.x,l.x)),p=a._gridClamp(Math.min(h.top()+l.y,l.y)),l=a._gridClamp(Math.max(h.bottom()+
l.y,l.y));l>=p;p++)for(var r=m;y>=r;r++){var q=d[16*p+r];if(q)for(var x=0;x<q.length;x++){var z=q[x];if(!(h.minzoom>=z.maxzoom||z.minzoom>=h.maxzoom)&&(c=a._calcPlacementZoom(h,z,c),2<=c))return E.C_INFINITY}}return 2>c?c:E.C_INFINITY},a._gridClamp=function(a){return E.clamp(a>>9,-7,8)},a._calcPlacementZoom=function(b,c,d){var f=c.anchor.x-b.anchor.x;if(0===f&&(b.right()<c.left()||c.right()<b.left()))return d;var h=c.anchor.y-b.anchor.y;if(0===h&&(b.bottom()<c.top()||c.bottom()<b.top()))return d;
var l=E.C_INFINITY;if(0!==f){var m=(0<f?b.right()-c.left():b.left()-c.right())/f;l>m&&(l=m);f=0<f?a._calcExtZoomX(b,c,m):a._calcExtZoomX(c,b,m);l>f&&(l=f)}0!==h&&(f=(0<h?b.bottom()-c.top():b.top()-c.bottom())/h,l>f&&(l=f),h=0<h?a._calcExtZoomY(b,c,f):a._calcExtZoomY(c,b,f),l>h&&(l=h));return l<b.minzoom||l<c.minzoom?d:(l=Math.min(l,b.maxzoom,c.maxzoom),d>l&&(l=d),l)},a._calcExtZoomX=function(a,c,d){var b,h,l,m;if(c.anchor.y+c.corners[0].y/d>a.anchor.y+a.corners[2].y/d){var y=a.corners[2].x-a.corners[3].x,
p=a.corners[2].y-a.corners[3].y,r=c.corners[1].x-c.corners[0].x,q=c.corners[1].y-c.corners[0].y;0<=y*q-p*r?a.anchor.y+a.corners[3].y/d<c.anchor.y+c.corners[0].y/d?(b=a.corners[3],h=c.corners[0],l=c.corners[1],m=1):(b=c.corners[0],h=a.corners[3],l=a.corners[2],m=-1):a.anchor.y+a.corners[2].y/d>c.anchor.y+c.corners[1].y/d?(b=a.corners[2],h=c.corners[0],l=c.corners[1],m=1):(b=c.corners[1],h=a.corners[3],l=a.corners[2],m=-1)}else y=a.corners[2].x-a.corners[1].x,p=a.corners[2].y-a.corners[1].y,r=c.corners[3].x-
c.corners[0].x,q=c.corners[3].y-c.corners[0].y,0>y*q-p*r?a.anchor.y+a.corners[1].y/d>c.anchor.y+c.corners[0].y/d?(b=a.corners[1],h=c.corners[0],l=c.corners[3],m=1):(b=c.corners[0],h=a.corners[1],l=a.corners[2],m=-1):a.anchor.y+a.corners[2].y/d<c.anchor.y+c.corners[3].y/d?(b=a.corners[2],h=c.corners[0],l=c.corners[3],m=1):(b=c.corners[3],h=a.corners[1],l=a.corners[2],m=-1);d=l.x-h.x;l=l.y-h.y;return m*((b.y-h.y)*d-(b.x-h.x)*l)/((a.anchor.x-c.anchor.x)*l-(a.anchor.y-c.anchor.y)*d)},a._calcExtZoomY=
function(a,c,d){var b,h,l,m;if(c.anchor.x+c.corners[1].x/d>a.anchor.x+a.corners[3].x/d){var y=a.corners[3].x-a.corners[2].x,p=a.corners[3].y-a.corners[2].y,r=c.corners[0].x-c.corners[1].x,q=c.corners[0].y-c.corners[1].y;0>y*q-p*r?a.anchor.x+a.corners[2].x/d<c.anchor.x+c.corners[1].x/d?(b=a.corners[2],h=c.corners[1],l=c.corners[0],m=1):(b=c.corners[1],h=a.corners[2],l=a.corners[3],m=-1):a.anchor.x+a.corners[3].x/d>c.anchor.x+c.corners[0].x/d?(b=a.corners[3],h=c.corners[1],l=c.corners[0],m=1):(b=c.corners[0],
h=a.corners[2],l=a.corners[3],m=-1)}else y=a.corners[3].x-a.corners[0].x,p=a.corners[3].y-a.corners[0].y,r=c.corners[2].x-c.corners[1].x,q=c.corners[2].y-c.corners[1].y,0<y*q-p*r?a.anchor.x+a.corners[0].x/d>c.anchor.x+c.corners[1].x/d?(b=a.corners[0],h=c.corners[1],l=c.corners[2],m=1):(b=c.corners[1],h=a.corners[0],l=a.corners[3],m=-1):a.anchor.x+a.corners[3].x/d<c.anchor.x+c.corners[2].x/d?(b=a.corners[3],h=c.corners[1],l=c.corners[2],m=1):(b=c.corners[2],h=a.corners[0],l=a.corners[3],m=-1);d=l.x-
h.x;l=l.y-h.y;return m*((b.y-h.y)*d-(b.x-h.x)*l)/((a.anchor.x-c.anchor.x)*l-(a.anchor.y-c.anchor.y)*d)},a}();a.ConflictEngine=z})},"esri/views/vectorTiles/TextShaping":function(){define(["require","exports","./Placement"],function(z,a,d){return function(){function a(a,d,m,b,c,h,f,k){this._glyphItems=a;this._maxWidth=d;this._lineHeight=m;this._letterSpacing=b;this._offset=c;this._hAnchor=h;this._vAnchor=f;this._justify=k}return a.prototype.getShaping=function(a,q){for(var m=this._glyphItems,b=this._letterSpacing,
c=this._offset[0],h=this._offset[1],f=[],k=a.length,l=0;k>l;l++){var A=a.charCodeAt(l),y=m[A];y&&(f.push(new d.ShapedGlyph(A,c,h)),c+=y.metrics.advance+b)}if(0<f.length){A=this._maxWidth;a=this._lineHeight;b=this._justify;c=f.length;k=h=m=0;if(0!==A)for(var p=y=0,l=0;c>l;l++){var r=f[l];if(r.x-=p,q?r.y-=a*m:r.y+=a*m,r.x>A&&0<y){for(var B=f[y+1].x,k=Math.max(B,k),x=y+1;l>=x;x++)q?f[x].y-=a:f[x].y+=a,f[x].x-=B;b&&this._applyJustification(f,h,y-1);h=y+1;y=0;p+=B;m++}32===r.glyph&&(y=l)}l=f[c-1];k=Math.max(k,
l.x+this._glyphItems[l.glyph].metrics.advance);b&&this._applyJustification(f,h,c-1);l=(b-this._hAnchor)*k;b=(-this._vAnchor*(m+1)+.5)*a;q&&m&&(b+=m*a);for(q=0;q<f.length;q++)a=f[q],a.x+=l,a.y+=b}return f},a.prototype._applyJustification=function(a,d,m){for(var b=a[m],b=(b.x+this._glyphItems[b.glyph].metrics.advance)*this._justify;m>=d;d++)a[d].x-=b},a}()})},"dojox/string/BidiEngine":function(){define(["dojo/_base/lang","dojo/_base/declare","dojo/Stateful"],function(z,a,d){function E(a,c,e,g,f){var d=
a;void 0===c&&(c=f.defInFormat);void 0===e&&(e=f.defOutFormat);void 0===g&&(g=f.defSwap);if(c!==e){var h,k=c.substring(0,1);h=c.substring(1,4);var l=e.substring(0,1),m=e.substring(1,4);"C"===h.charAt(0)&&(h=x(d),h="ltr"===h||"rtl"===h?h.toUpperCase():"L"===c.charAt(2)?"LTR":"RTL",c=k+h);"C"===m.charAt(0)&&(h=x(d),"rtl"===h?m="RTL":"ltr"===h?(d=d.split(""),d.reverse(),h=x(d.join("")),m=h.toUpperCase()):m="L"===e.charAt(2)?"LTR":"RTL",e=l+m)}if(c===e)return a;l=c.substring(0,1);d=c.substring(1,4);k=
e.substring(0,1);m=e.substring(1,4);f.inFormat=c;f.outFormat=e;f.swap=g;if("L"===l&&"VLTR"===e){if("LTR"===d)return f.dir=D,q(a,f);if("RTL"===d)return f.dir=K,q(a,f)}if("V"===l&&"V"===k)return f.dir="RTL"===d?K:D,b(a,f);if("L"===l&&"VRTL"===e)return f.dir="LTR"===d?D:K,a=q(a,f),b(a);if("VLTR"===c&&"LLTR"===e)return f.dir=D,q(a,f);if("V"===l&&"L"===k&&d!==m)return a=b(a),"RTL"===d?E(a,"LLTR","VLTR",g,f):E(a,"LRTL","VRTL",g,f);if("VRTL"===c&&"LRTL"===e)return E(a,"LRTL","VRTL",g,f);if("L"===l&&"L"===
k)return c=f.swap,f.swap=c.substr(0,1)+"N","RTL"===d?(f.dir=K,a=q(a,f),f.swap="N"+c.substr(1,2),f.dir=D,a=q(a,f)):(f.dir=D,a=q(a,f),f.swap="N"+c.substr(1,2),a=E(a,"VLTR","LRTL",f.swap,f)),a}function x(a){return(a=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(a))?"z">=a[0]?"ltr":"rtl":""}function q(a,b){a=a.split("");var c=[];m(a,c,b);if(0!==b.hiLevel&&b.swap.substr(0,1)!==b.swap.substr(1,2))for(var e=0;e<a.length;e++)if(1===c[e]){var g=e,d;b:{d=a[e];for(var h=void 0,
k=0,l=P.length-1;k<=l;)if(h=Math.floor((k+l)/2),d<P[h][0])l=h-1;else if(d>P[h][0])k=h+1;else{d=P[h][1];break b}}a[g]=d}f(2,a,c,b);f(1,a,c,b);H=c;return a.join("")}function m(a,b,c){var e=a.length,f=c.dir?ca:ea,g=null,d=null,h=null,g=0,d=d=null,l=-1,m=d=null,p=[],r=[];c.hiLevel=c.dir;c.lastArabic=!1;c.hasUbatAl=!1;c.hasUbatB=!1;c.hasUbatS=!1;for(d=0;d<e;d++){var m=d,h=a[d].charCodeAt(0),t=qa[h>>8];p[m]=t<ba?t:ra[t-ba][h&255]}for(m=0;m<e;m++){r[m]=d=k(a,p,r,m,c);g=f[g][d];d=g&240;g&=15;b[m]=h=f[g][w];
if(0<d){if(16===d)for(d=l;d<m;d++)b[d]=1;l=-1}if(d=f[g][n])-1===l&&(l=m);else if(-1<l){for(d=l;d<m;d++)b[d]=h;l=-1}p[m]===ha&&(b[m]=0);c.hiLevel|=h}if(c.hasUbatS)for(a=0;a<e;a++)if(p[a]===Y)for(b[a]=c.dir,f=a-1;0<=f;f--)if(p[f]===la)b[f]=c.dir;else break}function b(a,b){a=a.split("");if(b){var c=[];m(a,c,b);H=c}a.reverse();B.reverse();return a.join("")}function c(a){for(var b=0;b<W.length;b++)if(a>=W[b]&&a<=ja[b])return!0;return!1}function h(a,b,e,f){for(;b*e<f&&A(a[b]);)b+=e;return b*e<f&&c(a[b])?
!0:!1}function f(a,b,c,e){if(!(e.hiLevel<a))if(1!==a||e.dir!==K||e.hasUbatB){e=b.length;for(var f=0,d,g,h;f<e;){if(c[f]>=a){for(d=f+1;d<e&&c[d]>=a;)d++;for(g=d-1;f<g;f++,g--)h=b[f],b[f]=b[g],b[g]=h,h=B[f],B[f]=B[g],B[g]=h;f=d}f++}}else b.reverse(),B.reverse()}function k(a,b,c,e,f){return{UBAT_L:function(){f.lastArabic=!1;return fa},UBAT_R:function(){f.lastArabic=!1;return da},UBAT_ON:function(){return U},UBAT_AN:function(){return ga},UBAT_EN:function(){return f.lastArabic?ga:X},UBAT_AL:function(){f.lastArabic=
!0;f.hasUbatAl=!0;return da},UBAT_WS:function(){return U},UBAT_CS:function(){var a,d;if(1>e||e+1>=b.length||(a=c[e-1])!==X&&a!==ga||(d=b[e+1])!==X&&d!==ga)return U;f.lastArabic&&(d=ga);return d===a?d:U},UBAT_ES:function(){return(0<e?c[e-1]:ha)===X&&e+1<b.length&&b[e+1]===X?X:U},UBAT_ET:function(){if(0<e&&c[e-1]===X)return X;if(f.lastArabic)return U;for(var a=e+1,d=b.length;a<d&&b[a]===ma;)a++;return a<d&&b[a]===X?X:U},UBAT_NSM:function(){if("VLTR"===f.inFormat){for(var d=b.length,g=e+1;g<d&&b[g]===
na;)g++;if(g<d&&(d=a[e],g=b[g],(1425<=d&&2303>=d||64286===d)&&(g===da||g===ka)))return da}return 1>e||b[e-1]===ha?U:c[e-1]},UBAT_B:function(){f.lastArabic=!0;f.hasUbatB=!0;return f.dir},UBAT_S:function(){f.hasUbatS=!0;return U},UBAT_LRE:function(){f.lastArabic=!1;return U},UBAT_RLE:function(){f.lastArabic=!1;return U},UBAT_LRO:function(){f.lastArabic=!1;return U},UBAT_RLO:function(){f.lastArabic=!1;return U},UBAT_PDF:function(){f.lastArabic=!1;return U},UBAT_BN:function(){return U}}[oa[b[e]]]()}function l(a,
b){for(var c=0;c<t.length;c++)if(a===t[c])return b[c];return a}function A(a){return"\u064b"<=a&&"\u0655">=a?!0:!1}function y(a){if("L"===a)return"LTR";if("R"===a)return"RTL";if("C"===a)return"CLR";if("D"===a)return"CRL"}function p(a,b){for(var c=0;c<V.length;c++)if(a===V[c])return b[c];return a}function r(a,b,c,e){for(var f=0;f<a.length;f++)if(a[f]>b||!c&&a[f]===b)a[f]+=e}z.getObject("string",!0,dojox);z=a("dojox.string.BidiEngine",d,{inputFormat:"ILYNN",outputFormat:"VLNNN",sourceToTarget:[],targetToSource:[],
levels:[],bidiTransform:function(a,b,e){this.sourceToTarget=[];this.targetToSource=[];if(!a)return"";var f=this.sourceToTarget,d=this.targetToSource,g=a.length;B=[];H=[];for(var k=0;k<g;k++)f[k]=k,d[k]=k,B[k]=k;if(!this.checkParameters(b,e))return a;b=this.inputFormat;e=this.outputFormat;var f=a,f=C,k=y(b.charAt(1)),d=y(e.charAt(1)),m="I"===b.charAt(0)?"L":b.charAt(0),g="I"===e.charAt(0)?"L":e.charAt(0),k=m+k,d=g+d,g=b.charAt(2)+e.charAt(2);f.defInFormat=k;f.defOutFormat=d;f.defSwap=g;a=E(a,k,d,g,
f);f=!1;if("R"===e.charAt(1))f=!0;else if("C"===e.charAt(1)||"D"===e.charAt(1))f=this.checkContextual(a);d=this.sourceToTarget=B;g=Array(d.length);for(k=0;k<d.length;k++)g[d[k]]=k;G=this.targetToSource=g;if(b.charAt(3)===e.charAt(3))f=a;else if("S"===e.charAt(3))if(b=f,e=!0,0===a.length)f=void 0;else{void 0===b&&(b=!0);void 0===e&&(e=!0);a=String(a);a=a.split("");var n=0,d=1,f=a.length;b||(n=a.length-1,d=-1,f=1);for(var g=f,k=e,u=0,f=[],m=0;n*d<g;n+=d)if(c(a[n])||A(a[n])){var q;if(q="\u0644"===a[n])b:{for(var w=
a,x=n+d,D=d,z=g;x*D<z&&A(w[x]);)x+=D;q=" ";if(x*D<z)for(q=w[x],w=0;w<V.length;w++)if(V[w]===q){q=!0;break b}q=!1}if(q){a[n]=0===u?p(a[n+d],v):p(a[n+d],F);n+=d;u=a;q=n;w=d;for(x=g;q*w<x&&A(u[q]);)q+=w;q*w<x&&(u[q]=" ");k&&(f[m]=n,m++);u=0}else{q=a[n];if(1===u){w=n;if(h(a,n+d,d,g))b:for(x=a[n],D=0;D<t.length;D++){if(x===t[D]){x=aa[D];break b}}else x=l(a[n],T);a[w]=x}else!0===h(a,n+d,d,g)?a[n]=l(a[n],L):a[n]=l(a[n],J);A(q)||(u=1);b:{for(w=0;w<R.length;w++)if(R[w]===q){q=!0;break b}q=!1}!0===q&&(u=0)}}else u=
0;d="";for(g=0;g<a.length;g++){if(k=e){b:{for(k=0;k<f.length;k++)if(f[k]===g)break b;k=-1}k=-1<k}k?(r(G,g,!b,-1),B.splice(g,1)):d+=a[g]}f=d}else if(b=a,e=f,a=!0,0===b.length)f=void 0;else for(void 0===a&&(a=!0),void 0===e&&(e=!0),b=String(b),f="",d=[],d=b.split(""),g=0;g<b.length;g++)k=!1,"\ufe70"<=d[g]&&"\ufeff">d[g]?(m=b.charCodeAt(g),"\ufef5"<=d[g]&&"\ufefc">=d[g]?(e?(0<g&&a&&" "===d[g-1]?f=f.substring(0,f.length-1)+"\u0644":(f+="\u0644",k=!0),f+=V[(m-65269)/2]):(f+=V[(m-65269)/2],f+="\u0644",
g+1<b.length&&a&&" "===d[g+1]?g++:k=!0),k&&(r(G,g,!0,1),B.splice(g,0,B[g]))):f+=Q[m-65136]):f+=d[g];this.sourceToTarget=B;this.targetToSource=G;this.levels=H;return f},_inputFormatSetter:function(a){if(!I.test(a))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=a},_outputFormatSetter:function(a){if(!I.test(a))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=a},checkParameters:function(a,b){a?this.set("inputFormat",
a):a=this.inputFormat;b?this.set("outputFormat",b):b=this.outputFormat;return a===b?!1:!0},checkContextual:function(a){a=x(a);if("ltr"!==a&&"rtl"!==a){try{a=document.dir.toLowerCase()}catch(sa){}"ltr"!==a&&"rtl"!==a&&(a="ltr")}return a},hasBidiChar:function(a){return O.test(a)}});var B=[],G=[],H=[],C={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1},w=5,n=6,D=0,K=1,I=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,
O=/[\u0591-\u06ff\ufb1d-\ufefc]/,P=[["(",")"],[")","("],["\x3c","\x3e"],["\x3e","\x3c"],["[","]"],["]","["],["{","}"],["}","{"],["\u00ab","\u00bb"],["\u00bb","\u00ab"],["\u2039","\u203a"],["\u203a","\u2039"],["\u207d","\u207e"],["\u207e","\u207d"],["\u208d","\u208e"],["\u208e","\u208d"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232a"],["\u232a","\u2329"],["\ufe59","\ufe5a"],["\ufe5a","\ufe59"],["\ufe5b","\ufe5c"],["\ufe5c","\ufe5b"],["\ufe5d","\ufe5e"],["\ufe5e","\ufe5d"],["\ufe64","\ufe65"],
["\ufe65","\ufe64"]],V=["\u0622","\u0623","\u0625","\u0627"],v=["\ufef5","\ufef7","\ufef9","\ufefb"],F=["\ufef6","\ufef8","\ufefa","\ufefc"],t="\u0627\u0628\u062a\u062b\u062c\u062d\u062e\u062f\u0630\u0631\u0632\u0633\u0634\u0635\u0636\u0637\u0638\u0639\u063a\u0641\u0642\u0643\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u06cc\u0626\u0624".split(""),J="\ufe8d\ufe8f\ufe95\ufe99\ufe9d\ufea1\ufea5\ufea9\ufeab\ufead\ufeaf\ufeb1\ufeb5\ufeb9\ufebd\ufec1\ufec5\ufec9\ufecd\ufed1\ufed5\ufed9\ufedd\ufee1\ufee5\ufee9\ufeed\ufef1\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfc\ufe89\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe89\ufe85".split(""),
T="\ufe8e\ufe90\ufe96\ufe9a\ufe9e\ufea2\ufea6\ufeaa\ufeac\ufeae\ufeb0\ufeb2\ufeb6\ufeba\ufebe\ufec2\ufec6\ufeca\ufece\ufed2\ufed6\ufeda\ufede\ufee2\ufee6\ufeea\ufeee\ufef2\ufe88\ufe84\ufe82\ufe94\ufef0\ufbfd\ufe8a\ufe86\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8a\ufe86".split(""),aa="\ufe8e\ufe92\ufe98\ufe9c\ufea0\ufea4\ufea8\ufeaa\ufeac\ufeae\ufeb0\ufeb4\ufeb8\ufebc\ufec0\ufec4\ufec8\ufecc\ufed0\ufed4\ufed8\ufedc\ufee0\ufee4\ufee8\ufeec\ufeee\ufef4\ufe88\ufe84\ufe82\ufe94\ufef0\ufbff\ufe8c\ufe86\ufe71\ufe72\ufe74\ufe77\ufe79\ufe7b\ufe7d\ufe7f\ufe80\ufe8c\ufe86".split(""),
L="\ufe8d\ufe91\ufe97\ufe9b\ufe9f\ufea3\ufea7\ufea9\ufeab\ufead\ufeaf\ufeb3\ufeb7\ufebb\ufebf\ufec3\ufec7\ufecb\ufecf\ufed3\ufed7\ufedb\ufedf\ufee3\ufee7\ufeeb\ufeed\ufef3\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfe\ufe8b\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8b\ufe85".split(""),R="\u0621\u0622\u0623\u0624\u0625\u0627\u0629\u062f\u0630\u0631\u0632\u0648\u0649".split(""),Q="\u064b\u064b\u064c\u061f\u064d\u061f\u064e\u064e\u064f\u064f\u0650\u0650\u0651\u0651\u0652\u0652\u0621\u0622\u0622\u0623\u0623\u0624\u0624\u0625\u0625\u0626\u0626\u0626\u0626\u0627\u0627\u0628\u0628\u0628\u0628\u0629\u0629\u062a\u062a\u062a\u062a\u062b\u062b\u062b\u062b\u062c\u062c\u062c\u062c\u062d\u062d\u062d\u062d\u062e\u062e\u062e\u062e\u062f\u062f\u0630\u0630\u0631\u0631\u0632\u0632\u0633\u0633\u0633\u0633\u0634\u0634\u0634\u0634\u0635\u0635\u0635\u0635\u0636\u0636\u0636\u0636\u0637\u0637\u0637\u0637\u0638\u0638\u0638\u0638\u0639\u0639\u0639\u0639\u063a\u063a\u063a\u063a\u0641\u0641\u0641\u0641\u0642\u0642\u0642\u0642\u0643\u0643\u0643\u0643\u0644\u0644\u0644\u0644\u0645\u0645\u0645\u0645\u0646\u0646\u0646\u0646\u0647\u0647\u0647\u0647\u0648\u0648\u0649\u0649\u064a\u064a\u064a\u064a\ufef5\ufef6\ufef7\ufef8\ufef9\ufefa\ufefb\ufefc\u061f\u061f\u061f".split(""),
W=["\u0621","\u0641"],ja=["\u063a","\u064a"],ea=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],ca=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],fa=0,da=1,X=2,ga=3,U=4,ha=5,Y=6,ka=7,la=8,ma=11,na=12,oa="UBAT_L UBAT_R UBAT_EN UBAT_AN UBAT_ON UBAT_B UBAT_S UBAT_AL UBAT_WS UBAT_CS UBAT_ES UBAT_ET UBAT_NSM UBAT_LRE UBAT_RLE UBAT_PDF UBAT_LRO UBAT_RLO UBAT_BN".split(" "),ba=100;a=fa;d=da;var M=X,S=ga,e=U,ia=ha,pa=Y,g=ka,Z=la,N=ma,
u=na,qa=[ba+0,a,a,a,a,ba+1,ba+2,ba+3,d,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,ba+4,e,e,e,a,e,a,e,a,e,e,e,a,a,e,e,a,a,a,a,a,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,a,a,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,a,a,a,a,a,a,a,a,a,a,a,a,a,a,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,a,a,e,e,a,a,e,e,a,a,e,e,e,e,e,e,e,e,e,e,e,e,e,e,
e,e,e,e,e,e,e,e,e,a,a,a,ba+5,g,g,ba+6,ba+7],ra=[[18,18,18,18,18,18,18,18,18,pa,ia,pa,Z,ia,18,18,18,18,18,18,18,18,18,18,18,18,18,18,ia,ia,ia,pa,Z,e,e,N,N,N,e,e,e,e,e,10,9,10,9,9,M,M,M,M,M,M,M,M,M,M,9,e,e,e,e,e,e,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,e,e,e,e,e,e,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,e,e,e,e,18,18,18,18,18,18,ia,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,9,e,N,N,N,N,e,e,e,e,a,e,e,18,e,e,N,N,M,M,e,a,e,e,e,M,a,e,e,e,e,e,a,
a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,e,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,e,a,a,a,a,a,a,a,a],[a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,e,e,e,e,e,e,e,e,e,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,e,e,a,a,a,a,a,a,a,e,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,e,a,e,e,e,e,e,e,e,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,
u,u,u,d,u,d,u,u,d,u,u,d,u,e,e,e,e,e,e,e,e,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,e,e,e,e,e,d,d,d,d,d,e,e,e,e,e,e,e,e,e,e,e],[S,S,S,S,e,e,e,e,g,N,N,g,9,g,e,e,u,u,u,u,u,u,u,u,u,u,u,g,e,e,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,S,S,S,S,S,S,S,S,S,S,N,S,S,g,g,g,u,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,
g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,u,u,u,u,u,u,u,S,e,u,u,u,u,u,u,g,g,u,u,e,u,u,u,u,g,g,M,M,M,M,M,M,M,M,M,M,g,g,g,g,g,g],[g,g,g,g,g,g,g,g,g,g,g,g,g,g,e,g,g,u,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,e,e,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,u,u,u,u,u,u,u,u,u,
u,u,g,e,e,e,e,e,e,e,e,e,e,e,e,e,e,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,u,u,u,u,u,u,u,u,u,d,d,e,e,e,e,d,e,e,e,e,e],[Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,18,18,18,a,d,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,Z,ia,13,14,15,16,17,9,N,N,N,N,N,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,9,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,Z,18,18,18,18,18,e,e,e,e,e,18,18,18,18,18,18,M,a,e,e,M,M,M,M,M,M,10,10,e,e,e,a,M,M,M,M,M,M,M,M,M,M,10,10,e,e,e,e,a,a,a,a,a,a,a,a,a,a,a,a,a,
e,e,e,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[a,a,a,a,a,a,a,e,e,e,e,e,e,e,e,e,e,e,e,a,a,a,a,a,e,e,e,e,e,d,u,d,d,d,d,d,d,d,d,d,d,10,d,d,d,d,d,d,d,d,d,d,d,d,d,e,d,d,d,d,d,e,d,e,d,d,e,d,d,e,d,d,d,d,d,d,d,d,d,d,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,
g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g],[u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,u,u,u,u,u,u,u,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,9,e,9,e,e,9,e,e,e,e,e,e,e,e,e,N,e,e,10,10,e,e,e,e,e,N,N,e,e,e,e,e,g,g,g,g,g,e,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,
g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,e,e,18],[e,e,e,N,N,N,e,e,e,e,e,10,9,10,9,9,M,M,M,M,M,M,M,M,M,M,9,e,e,e,e,e,e,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,e,e,e,e,e,e,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,e,e,e,e,e,e,e,e,e,e,e,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,
a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,e,e,e,a,a,a,a,a,a,e,e,a,a,a,a,a,a,e,e,a,a,a,a,a,a,e,e,a,a,a,e,e,e,N,N,e,e,e,N,N,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]];return z})},"esri/views/vectorTiles/TileClipper":function(){define(["require","exports","./Geometry","./GeometryUtils"],function(z,a,d,E){Object.defineProperty(a,"__esModule",{value:!0});var x=function(){return function(a,b,c){this.ratio=a;this.x=b;this.y=c}}();
z=function(){function a(a,c,d){this.dz=a;this.yPos=c;this.xPos=d}return a.prototype.setExtent=function(a){this.finalRatio=4096/a*(1<<this.dz);var b;b=64/this.finalRatio;a>>=this.dz;b>a&&(b=a);this.margin=b;this.xmin=a*this.xPos-b;this.ymin=a*this.yPos-b;this.xmax=this.xmin+a+2*b;this.ymax=this.ymin+a+2*b},a.prototype.reset=function(a){this.type=a;this._prevIsIn=!1;this.lines=[];this.line=null},a.prototype.moveTo=function(a,c){this._pushLine();this._prevIsIn=this._isIn(a,c);this._moveTo(a,c,this._prevIsIn);
this._prevPt=new d.Point(a,c);this._firstPt=new d.Point(a,c)},a.prototype.lineTo=function(a,c){var b,f,k,l,m,q,p,r,B=this._isIn(a,c);if(B)this._prevIsIn?this._lineTo(a,c,!0):(b=this._prevPt,f=new d.Point(a,c),k=this._intersect(f,b),this._lineTo(k.x,k.y,!0),this._lineTo(f.x,f.y,!0));else{if(this._prevIsIn)f=this._prevPt,b=new d.Point(a,c),k=this._intersect(f,b),this._lineTo(k.x,k.y,!0);else if(k=this._prevPt,b=new d.Point(a,c),!(k.x<=this.xmin&&b.x<=this.xmin||k.x>=this.xmax&&b.x>=this.xmax||k.y<=
this.ymin&&b.y<=this.ymin||k.y>=this.ymax&&b.y>=this.ymax))if(f=[],(k.x<this.xmin&&b.x>this.xmin||k.x>this.xmin&&b.x<this.xmin)&&(l=(this.xmin-k.x)/(b.x-k.x),r=k.y+l*(b.y-k.y),r<=this.ymin?q=!1:r>=this.ymax?q=!0:f.push(new x(l,this.xmin,r))),(k.x<this.xmax&&b.x>this.xmax||k.x>this.xmax&&b.x<this.xmax)&&(l=(this.xmax-k.x)/(b.x-k.x),r=k.y+l*(b.y-k.y),r<=this.ymin?q=!1:r>=this.ymax?q=!0:f.push(new x(l,this.xmax,r))),(k.y<this.ymin&&b.y>this.ymin||k.y>this.ymin&&b.y<this.ymin)&&(l=(this.ymin-k.y)/(b.y-
k.y),p=k.x+l*(b.x-k.x),p<=this.xmin?m=!1:p>=this.xmax?m=!0:f.push(new x(l,p,this.ymin))),(k.y<this.ymax&&b.y>this.ymax||k.y>this.ymax&&b.y<this.ymax)&&(l=(this.ymax-k.y)/(b.y-k.y),p=k.x+l*(b.x-k.x),p<=this.xmin?m=!1:p>=this.xmax?m=!0:f.push(new x(l,p,this.ymax))),0===f.length)m?q?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):q?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(1<f.length&&f[0].ratio>f[1].ratio)this._lineTo(f[1].x,f[1].y,!0),
this._lineTo(f[0].x,f[0].y,!0);else for(l=0;l<f.length;l++)this._lineTo(f[l].x,f[l].y,!0);this._lineTo(b.x,b.y,!1)}this._prevIsIn=B;this._prevPt=new d.Point(a,c)},a.prototype.close=function(){var a,c;0<this.line.length&&(a=this._firstPt,c=this._prevPt,a.x===c.x&&a.y===c.y||this.lineTo(a.x,a.y),a=this.line,c=a.length,4<=c&&(a[0].x===a[1].x&&a[0].x===a[c-2].x||a[0].y===a[1].y&&a[0].y===a[c-2].y)&&(a.pop(),a[0].x=a[c-2].x,a[0].y=a[c-2].y))},a.prototype.result=function(){return this._pushLine(),0===this.lines.length?
null:(3===this.type&&q.simplify(this.margin*this.finalRatio,this.lines),this.lines)},a.prototype._isIn=function(a,c){return a>=this.xmin&&a<=this.xmax&&c>=this.ymin&&c<=this.ymax},a.prototype._intersect=function(a,c){var b,f;if(c.x>=this.xmin&&c.x<=this.xmax)f=c.y<=this.ymin?this.ymin:this.ymax,b=a.x+(f-a.y)/(c.y-a.y)*(c.x-a.x);else if(c.y>=this.ymin&&c.y<=this.ymax)b=c.x<=this.xmin?this.xmin:this.xmax,f=a.y+(b-a.x)/(c.x-a.x)*(c.y-a.y);else{f=c.y<=this.ymin?this.ymin:this.ymax;b=c.x<=this.xmin?this.xmin:
this.xmax;var k=(b-a.x)/(c.x-a.x),l=(f-a.y)/(c.y-a.y);l>k?f=a.y+k*(c.y-a.y):b=a.x+l*(c.x-a.x)}return new d.Point(b,f)},a.prototype._pushLine=function(){this.line&&(1===this.type?0<this.line.length&&this.lines.push(this.line):2===this.type?1<this.line.length&&this.lines.push(this.line):3===this.type&&3<this.line.length&&this.lines.push(this.line));this.line=[]},a.prototype._moveTo=function(a,c,h){3!==this.type?h&&(a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),c=Math.round((c-(this.ymin+
this.margin))*this.finalRatio),this.line.push(new d.Point(a,c))):(h||(a<this.xmin&&(a=this.xmin),a>this.xmax&&(a=this.xmax),c<this.ymin&&(c=this.ymin),c>this.ymax&&(c=this.ymax)),a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),c=Math.round((c-(this.ymin+this.margin))*this.finalRatio),this.line.push(new d.Point(a,c)),this._is_h=!1,this._is_v=!1)},a.prototype._lineTo=function(a,c,h){var b,k;if(3!==this.type)h?(a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),c=Math.round((c-(this.ymin+
this.margin))*this.finalRatio),0<this.line.length&&(b=this.line[this.line.length-1],b.equals(a,c)))||this.line.push(new d.Point(a,c)):this.line&&0<this.line.length&&this._pushLine();else if(h||(a<this.xmin&&(a=this.xmin),a>this.xmax&&(a=this.xmax),c<this.ymin&&(c=this.ymin),c>this.ymax&&(c=this.ymax)),a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),c=Math.round((c-(this.ymin+this.margin))*this.finalRatio),this.line&&0<this.line.length){b=this.line[this.line.length-1];h=b.x===a;var l=b.y===
c;h&&l||(this._is_h&&h?(b.x=a,b.y=c,k=this.line[this.line.length-2],this._is_h=k.x===a,this._is_v=k.y===c):this._is_v&&l?(b.x=a,b.y=c,k=this.line[this.line.length-2],this._is_h=k.x===a,this._is_v=k.y===c):(this.line.push(new d.Point(a,c)),this._is_h=h,this._is_v=l))}else this.line.push(new d.Point(a,c))},a}();a.TileClipper=z;z=function(){function a(){}return a.prototype.setExtent=function(a){this._ratio=4096===a?1:4096/a},a.prototype.reset=function(a){this.type=a;this.lines=[];this.line=null},a.prototype.moveTo=
function(a,c){this.line&&this.lines.push(this.line);this.line=[];var b=this._ratio;this.line.push(new d.Point(Math.round(a*b),Math.round(c*b)))},a.prototype.lineTo=function(a,c){var b=this._ratio;this.line.push(new d.Point(Math.round(a*b),Math.round(c*b)))},a.prototype.close=function(){var a=this.line;a&&!a[0].isEqual(a[a.length-1])&&a.push(a[0])},a.prototype.result=function(){return this.line&&this.lines.push(this.line),0===this.lines.length?null:(3===this.type&&1!==this._ratio&&q.simplify(64,this.lines),
this.lines)},a}();a.SimpleBuilder=z;var q=function(){function a(){}return a.simplify=function(b,c){if(c){var d=-b,f=4096+b,k=-b,l=4096+b;b=[];for(var m=[],q=c.length,p=0;q>p;++p){var r=c[p];if(r&&!(2>r.length))for(var x=r[0],z=void 0,E=r.length,C=1;E>C;++C)z=r[C],x.x===z.x&&(x.x<=d&&(x.y>z.y?(b.push(p),b.push(C),b.push(0),b.push(-1)):(m.push(p),m.push(C),m.push(0),m.push(-1))),x.x>=f&&(x.y<z.y?(b.push(p),b.push(C),b.push(1),b.push(-1)):(m.push(p),m.push(C),m.push(1),m.push(-1)))),x.y===z.y&&(x.y<=
k&&(x.x<z.x?(b.push(p),b.push(C),b.push(2),b.push(-1)):(m.push(p),m.push(C),m.push(2),m.push(-1))),x.y>=l&&(x.x>z.x?(b.push(p),b.push(C),b.push(3),b.push(-1)):(m.push(p),m.push(C),m.push(3),m.push(-1)))),x=z}0!==b.length&&0!==m.length&&(a.fillParent(c,m,b),a.fillParent(c,b,m),d=[],a.calcDeltas(d,m,b),a.calcDeltas(d,b,m),a.addDeltas(d,c))}},a.fillParent=function(a,c,d){for(var b=d.length,h=c.length,l=0;h>l;l+=4){for(var m=c[l],q=c[l+1],p=c[l+2],r=a[m][q-1],m=a[m][q],q=8092,x=-1,z=0;b>z;z+=4)if(d[z+
2]===p){var H=d[z],C=d[z+1],w=a[H][C-1],H=a[H][C];switch(p){case 0:case 1:E.between(r.y,w.y,H.y)&&E.between(m.y,w.y,H.y)&&(w=Math.abs(H.y-w.y),q>w&&(q=w,x=z));break;case 2:case 3:E.between(r.x,w.x,H.x)&&E.between(m.x,w.x,H.x)&&(w=Math.abs(H.x-w.x),q>w&&(q=w,x=z))}}c[l+3]=x}},a.calcDeltas=function(b,c,d){for(var f=c.length,h=0;f>h;h+=4){var l=a.calcDelta(h,c,d,[]);b.push(c[h]);b.push(c[h+1]);b.push(c[h+2]);b.push(l)}},a.calcDelta=function(b,c,d,f){b=c[b+3];if(-1===b)return 0;var h=f.length;return 1<
h&&f[h-2]===b?0:(f.push(b),a.calcDelta(b,d,c,f)+1)},a.addDeltas=function(a,c){for(var b=a.length,d=0,k=0;b>k;k+=4){var l=a[k+3];l>d&&(d=l)}for(k=0;b>k;k+=4){var m=c[a[k]],q=a[k+1],l=d-a[k+3];switch(a[k+2]){case 0:m[q-1].x-=l;m[q].x-=l;break;case 1:m[q-1].x+=l;m[q].x+=l;break;case 2:m[q-1].y-=l;m[q].y-=l;break;case 3:m[q-1].y+=l,m[q].y+=l}}a=c.length;for(b=0;a>b;++b)m=c[b],!m||2>m.length||m[m.length-1].x!==m[0].x&&m[m.length-1].y!==m[0].y&&m.push(m[0])},a}()})},"*noref":1}});
define("require exports dojo/Deferred ../../core/promiseUtils ./WorkerTile ./style/StyleRepository".split(" "),function(z,a,d,E,x,q){return function(){function a(){this._tiles=new Map;this._spriteInfo={};this._glyphInfo={}}return a.prototype.reset=function(){var a=new d;this._spriteInfo={};this._glyphInfo={};var c=this._tiles;return c.forEach(function(a){return a.setObsolete()}),c.clear(),a.resolve(),a.promise},a.prototype.getLayers=function(){return this._layers},a.prototype.setLayers=function(a){return this._layers=
(new q(a)).layers,E.resolve({data:""})},a.prototype.getTile=function(a,c){var b=this,d=a.key,k=x.pool.acquire();k.initialize(a.key,a.refKey,this,a.rotation);var l=a.cacheTile;return c.invoke("fetchTileData",a.refKey).then(function(a){return k.setDataAndParse(a.protobuff,c).then(function(a){return l&&6!==k.status&&b._tiles.set(d,k),a}).otherwise(function(a){return k.setObsolete(),x.pool.release(k),b._tiles["delete"](k.tileKey),E.reject(a)})}).otherwise(function(a){return k.setObsolete(),b._tiles.has(k.tileKey)&&
b._tiles["delete"](k.tileKey),E.reject(a)}).always(function(a){return l||x.pool.release(k),a})},a.prototype.update=function(a){var b=this._tiles.get(a.key);return b?b.updateSymbols(a.rotation):E.reject()},a.prototype.destructTileData=function(a){return this._tiles.has(a.key)&&(x.pool.release(this._tiles.get(a.key)),this._tiles["delete"](a.key)),E.resolve()},a.prototype.fetchSprites=function(a,c){var b=[],d=this._spriteInfo;return a.forEach(function(a){void 0===d[a]&&b.push(a)}),0===b.length?E.resolve():
c.invoke("getSprites",{sprites:b}).then(function(a){a=a.spriteItems;for(var b in a)d[b]=a[b]})},a.prototype.getSpriteItems=function(){return this._spriteInfo},a.prototype.fetchGlyphs=function(a,c,d,f){var b=[],h=this._glyphInfo[c];return h?d.forEach(function(a){h[a]||b.push(a)}):(h=this._glyphInfo[c]=[],d.forEach(function(a){return b.push(a)})),0===b.length?E.resolve():f.invoke("getGlyphs",{tileID:a,font:c,codePoints:b}).then(function(a){a=a.glyphItems;for(var b in a)h[b]=a[b]})},a.prototype.getGlyphItems=
function(a){return this._glyphInfo[a]},a}()});