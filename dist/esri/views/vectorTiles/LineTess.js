//>>built
define(["require","exports"],function(O,h){function P(a){var c,b={items:[],count:0};for(c=0;a>c;++c)b.items.push(void 0);return b}function G(a,c){return a[0]*c[0]+a[1]*c[1]}function Q(a){return Math.sqrt(G(a,a))}function L(a,c){var b=Q(c);return a[0]=c[0]/b,a[1]=c[1]/b,a}function w(a,c){return a[0]=-c[1],a[1]=c[0],a}function H(a,c){return a[0]*c[1]-a[1]*c[0]}function r(a,c){return a[0]=-c[0],a[1]=-c[1],a}function v(a,c,b){return a[0]=c[0]*b,a[1]=c[1]*b,a}function A(a,c,b){return a[0]=c[0]+b[0],a[1]=
c[1]+b[1],a}function S(a,c){a=G(a,c);return.999<a?0:-.999>a?Math.PI:Math.acos(a)}function R(a,c,b,d,x){if(0===d)return void(a.count=0);var n=Q(c),f=v(e[0],c,1/n);b=v(e[1],b,1/n);f=S(f,b);f=(x?-1:1)*f/d;x=Math.cos(f);f=Math.sin(f);b=c[0];var g=c[1];for(c=0;d-1>c;++c)n=b,b=x*n-f*g,g=f*n+x*g,a.items[c][0]=b,a.items[c][1]=g;a.count=d-1}function E(a){var c,b=a.count,d=Math.floor(b/2);for(c=0;d>c;++c){var x=a.items[c];a.items[c]=a.items[b-c-1];a.items[b-c-1]=x}}function M(a,c,b){b=w(e[0],b);c=r(e[1],b);
var d=a.vectors.items[0];d.vector[0]=b[0];d.vector[1]=b[1];d.texCoords[0]=k;d.texCoords[1]=B;b=a.vectors.items[1];b.vector[0]=c[0];b.vector[1]=c[1];b.texCoords[0]=k;b.texCoords[1]=C;a.vectors.count=2;c=a.lists[l.ENTRY];c.items[0]=0;c.items[1]=1;c.count=2;c=a.lists[l.EXIT];c.items[0]=0;c.items[1]=1;c.count=2;a.lists[l.CAP].count=0;a.capCenter=void 0}Object.defineProperty(h,"__esModule",{value:!0});var l;!function(a){a[a.ENTRY=1]="ENTRY";a[a.EXIT=2]="EXIT";a[a.CAP=3]="CAP"}(l=h.VectorRole||(h.VectorRole=
{}));var I;!function(a){a[a.START=1]="START";a[a.END=2]="END"}(I=h.CapPosition||(h.CapPosition={}));h.SYSTEM_MAG_LIMIT=3.8;h.MITER_SAFE_RADS=2*Math.acos(1/h.SYSTEM_MAG_LIMIT);var N=h.SYSTEM_MAG_LIMIT*h.SYSTEM_MAG_LIMIT,B=-1,C=1,k=0,U=16/(2*Math.PI);h.allocTriangles=function(a){var c,b={items:[],count:0};for(c=0;a>c;++c)b.items.push({v1:{vector:[void 0,void 0],texCoords:[void 0,void 0]},v2:{vector:[void 0,void 0],texCoords:[void 0,void 0]},v3:{vector:[void 0,void 0],texCoords:[void 0,void 0]}});return b};
h.allocExtrudeVectors=function(){var a,c={items:[],count:0};for(a=0;30>a;++a)c.items.push({vector:[void 0,void 0],texCoords:[void 0,void 0]});a={};a[l.ENTRY]=P(20);a[l.EXIT]=P(20);a[l.CAP]=P(20);return{vectors:c,lists:a}};h.copyExtrudeVectors=function(a,c){var b;for(b=0;b<c.vectors.count;++b)a.vectors.items[b].vector[0]=c.vectors.items[b].vector[0],a.vectors.items[b].vector[1]=c.vectors.items[b].vector[1],a.vectors.items[b].texCoords[0]=c.vectors.items[b].texCoords[0],a.vectors.items[b].texCoords[1]=
c.vectors.items[b].texCoords[1],a.vectors.items[b].base=c.vectors.items[b].base;a.vectors.count=c.vectors.count;a.capCenter=c.capCenter};var e=[];for(O=0;32>O;++O)e.push([void 0,void 0]);var q=function(a){var c,b={items:[],count:0};for(c=0;a>c;++c)b.items.push([void 0,void 0]);return b}(16);h.length=Q;h.normalize=L;h.getNumberOfSlices=function(a){return Math.round(a*U)};h.getRads=S;var J=[void 0,void 0],K=[void 0,void 0];h.bridge=function(a,c,b){var d,x,e=c.vectors,f=c.lists[l.EXIT];x=b.vectors;var g=
b.lists[l.ENTRY];if(f.count===g.count+1)b=f.items,c=e.items,d=g.items,x=x.items;else{if(g.count!==f.count+1&&f.count!==g.count)return console.error("Cannot bridge "+f.count+" to "+g.count+"."),void(a.count=0);b=g.items;c=x.items;d=f.items;x=e.items}e=f.count+g.count-2;a.count=e;J[0]=b;J[1]=d;K[0]=c;K[1]=x;for(b=0;e>b;++b)c=a.items[b],d=(b+0)%2,d=K[d][J[d][Math.floor((b+0)/2)]],c.v1.vector[0]=d.vector[0],c.v1.vector[1]=d.vector[1],c.v1.texCoords[0]=d.texCoords[0],c.v1.texCoords[1]=d.texCoords[1],c.v1.base=
d.base,d=(b+1)%2,d=K[d][J[d][Math.floor((b+1)/2)]],c.v2.vector[0]=d.vector[0],c.v2.vector[1]=d.vector[1],c.v2.texCoords[0]=d.texCoords[0],c.v2.texCoords[1]=d.texCoords[1],c.v2.base=d.base,d=(b+2)%2,d=K[d][J[d][Math.floor((b+2)/2)]],c.v3.vector[0]=d.vector[0],c.v3.vector[1]=d.vector[1],c.v3.texCoords[0]=d.texCoords[0],c.v3.texCoords[1]=d.texCoords[1],c.v3.base=d.base};h.pie=function(a,c){if(0===c.lists[l.CAP].count)return void(a.count=0);if(1===c.lists[l.CAP].count)return console.error("A single vector is not enough to define a pie."),
void(a.count=0);a.count=c.lists[l.CAP].count-1;var b;for(b=0;b<a.count;++b){var d=a.items[b],e=c.vectors.items[c.lists[l.CAP].items[b]];d.v1.vector[0]=e.vector[0];d.v1.vector[1]=e.vector[1];d.v1.texCoords[0]=e.texCoords[0];d.v1.texCoords[1]=e.texCoords[1];d.v1.base=e.base;e=c.vectors.items[c.lists[l.CAP].items[b+1]];d.v2.vector[0]=e.vector[0];d.v2.vector[1]=e.vector[1];d.v2.texCoords[0]=e.texCoords[0];d.v2.texCoords[1]=e.texCoords[1];d.v2.base=e.base;e=c.vectors.items[c.capCenter];d.v3.vector[0]=
e.vector[0];d.v3.vector[1]=e.vector[1];d.v3.texCoords[0]=e.texCoords[0];d.v3.texCoords[1]=e.texCoords[1];d.v3.base=e.base}};h.buttCap=function(a,c,b){M(a,c,b)};h.roundCap=function(a,c,b,d,e,n){void 0===n&&(n=0);M(a,c,b);b=d===I.START?0:1;d=d===I.START?1:0;a.capCenter=a.vectors.count;c=a.vectors.items[a.capCenter];c.vector[0]=0;c.vector[1]=0;c.texCoords[0]=k;c.texCoords[1]=k;++a.vectors.count;R(q,a.vectors.items[b].vector,a.vectors.items[d].vector,e,!1);e=a.vectors.count;c=a.lists[l.CAP];c.items[0]=
b;var f=a.vectors.items[b].texCoords[1],g=a.vectors.items[d].texCoords[1];for(b=0;b<q.count;++b){var x=n*(1-Math.abs(q.count/2-b)/(q.count/2)),h=f+b/(q.count-1)*(g-f),p=q.items[b],r=a.vectors.items[e+b];r.vector[0]=p[0];r.vector[1]=p[1];r.texCoords[0]=x;r.texCoords[1]=h;c.items[b+1]=e+b}c.items[q.count+1]=d;c.count=q.count+2;a.vectors.count=e+q.count};var y=Math.cos(Math.PI/4),F=Math.sin(Math.PI/4),T=Math.sqrt(2);h.squareCap=function(a,c,b,d){M(a,c,b);c=d===I.START?0:1;b=d===I.START?1:0;var k=e[0],
l=e[1],f=e[2],g=e[3];d=e[4];var h=a.vectors.items[c].vector;k[0]=y*h[0]-F*h[1];k[1]=F*h[0]+y*h[1];v(g,k,T);l[0]=y*k[0]-F*k[1];l[1]=F*k[0]+y*k[1];f[0]=y*l[0]-F*l[1];f[1]=F*l[0]+y*l[1];v(d,f,T);c=a.vectors.items[c];c.vector[0]=g[0];c.vector[1]=g[1];a=a.vectors.items[b];a.vector[0]=d[0];a.vector[1]=d[1]};h.fastMiterJoin=M;h.miterJoin=function(a,c,b){c=w(e[0],c);b=w(e[1],b);var d=e[2];d[0]=c[0]+b[0];d[1]=c[1]+b[1];b=L(e[3],d);c=G(b,c);b=v(e[4],b,1/c);c=r(e[5],b);d=a.vectors.items[0];d.vector[0]=b[0];
d.vector[1]=b[1];d.texCoords[0]=k;d.texCoords[1]=B;b=a.vectors.items[1];b.vector[0]=c[0];b.vector[1]=c[1];b.texCoords[0]=k;b.texCoords[1]=C;a.vectors.count=2;c=a.lists[l.ENTRY];c.items[0]=0;c.items[1]=1;c.count=2;c=a.lists[l.EXIT];c.items[0]=0;c.items[1]=1;c.count=2;a.lists[l.CAP].count=0;a.capCenter=void 0};h.bevelJoin=function(a,c,b,d){var h=d*d;d=H(c,b);var n=0<d?[B,C]:[C,B],f=n[0],n=n[1],g=0<d?r(e[0],w(e[1],c)):w(e[2],c),u=0<d?r(e[3],w(e[4],b)):w(e[5],b),q=e[6];q[0]=g[0]+u[0];q[1]=g[1]+u[1];var q=
L(e[7],q),p=r(e[8],q),D=G(q,g),m=H(q,g),z=Math.abs(m/D),y=1+z*z,t=N>y?[z,!1]:[Math.sqrt(N-1),!0],m=t[0],t=t[1],z=h>y?[z,!1]:[Math.sqrt(h-1),!0],h=z[0];(z=z[1])&&t?(t=a.vectors.items[0],A(t.vector,r(e[9],g),v(e[10],r(e[11],c),m)),t.texCoords[0]=k,t.texCoords[1]=f,p=a.vectors.items[1],A(p.vector,r(e[12],u),v(e[13],b,m)),p.texCoords[0]=k,p.texCoords[1]=f,f=a.vectors.items[2],f.vector[0]=0,f.vector[1]=0,f.texCoords[0]=k,f.texCoords[1]=k,f=a.vectors.items[3],A(f.vector,g,v(e[14],c,h)),f.texCoords[0]=k,
f.texCoords[1]=n,c=a.vectors.items[4],A(c.vector,u,v(e[15],r(e[16],b),h)),c.texCoords[0]=k,c.texCoords[1]=n,a.vectors.count=5,b=a.lists[l.ENTRY],b.items[0]=0,b.items[1]=2,b.items[2]=3,b.count=3,b=a.lists[l.EXIT],b.items[0]=1,b.items[1]=2,b.items[2]=4,b.count=3,b=a.lists[l.CAP],b.items[0]=3,b.items[1]=4,b.count=2,a.capCenter=2):!z&&t?(t=a.vectors.items[0],A(t.vector,r(e[9],g),v(e[10],r(e[11],c),m)),t.texCoords[0]=k,t.texCoords[1]=f,p=a.vectors.items[1],A(p.vector,r(e[12],u),v(e[13],b,m)),p.texCoords[0]=
k,p.texCoords[1]=f,f=a.vectors.items[2],f.vector[0]=0,f.vector[1]=0,f.texCoords[0]=k,f.texCoords[1]=k,f=a.vectors.items[3],v(f.vector,q,1/D),f.texCoords[0]=k,f.texCoords[1]=n,a.vectors.count=4,b=a.lists[l.ENTRY],b.items[0]=0,b.items[1]=2,b.items[2]=3,b.count=3,b=a.lists[l.EXIT],b.items[0]=1,b.items[1]=2,b.items[2]=3,b.count=3,a.lists[l.CAP].count=0,a.capCenter=void 0):z&&!t?(t=a.vectors.items[0],v(t.vector,p,1/D),t.texCoords[0]=k,t.texCoords[1]=f,p=a.vectors.items[1],p.vector[0]=0,p.vector[1]=0,p.texCoords[0]=
k,p.texCoords[1]=k,f=a.vectors.items[2],A(f.vector,g,v(e[9],c,h)),f.texCoords[0]=k,f.texCoords[1]=n,f=a.vectors.items[3],A(f.vector,u,v(e[10],r(e[11],b),h)),f.texCoords[0]=k,f.texCoords[1]=n,a.vectors.count=4,b=a.lists[l.ENTRY],b.items[0]=0,b.items[1]=1,b.items[2]=2,b.count=3,b=a.lists[l.EXIT],b.items[0]=0,b.items[1]=1,b.items[2]=3,b.count=3,b=a.lists[l.CAP],b.items[0]=2,b.items[1]=3,b.count=2,a.capCenter=1):z||t||(t=a.vectors.items[0],v(t.vector,p,1/D),t.texCoords[0]=k,t.texCoords[1]=f,p=a.vectors.items[1],
v(p.vector,q,1/D),p.texCoords[0]=k,p.texCoords[1]=n,a.vectors.count=2,b=a.lists[l.ENTRY],b.items[0]=0,b.items[1]=1,b.count=2,b=a.lists[l.EXIT],b.items[0]=0,b.items[1]=1,b.count=2,a.lists[l.CAP].count=0,a.capCenter=void 0);0>d&&(E(a.lists[l.ENTRY]),E(a.lists[l.EXIT]))};h.roundJoin=function(a,c,b,d){var h=H(c,b),n=0<h?[B,C]:[C,B],f=n[0],n=n[1],g=0<h?r(e[0],w(e[1],c)):w(e[2],c),u=0<h?r(e[3],w(e[4],b)):w(e[5],b),y=e[6];y[0]=g[0]+u[0];y[1]=g[1]+u[1];var p=L(e[7],y),y=r(e[8],p),D=G(p,g),p=H(p,g),p=Math.abs(p/
D),m=N>1+p*p?[p,!1]:[Math.sqrt(N-1),!0],p=m[0];m[1]?(m=a.vectors.items[0],m.vector[0]=g[0],m.vector[1]=g[1],m.texCoords[0]=k,m.texCoords[1]=n,m=a.vectors.items[1],m.vector[0]=u[0],m.vector[1]=u[1],m.texCoords[0]=k,m.texCoords[1]=n,m=a.vectors.items[2],A(m.vector,r(e[9],g),v(e[10],r(e[11],c),p)),m.texCoords[0]=k,m.texCoords[1]=f,c=a.vectors.items[3],A(c.vector,r(e[12],u),v(e[13],b,p)),c.texCoords[0]=k,c.texCoords[1]=f,b=a.vectors.items[4],b.vector[0]=0,b.vector[1]=0,b.texCoords[0]=k,b.texCoords[1]=
k,a.vectors.count=5,b=a.lists[l.ENTRY],b.items[0]=2,b.items[1]=4,b.items[2]=0,b.count=3,b=a.lists[l.EXIT],b.items[0]=3,b.items[1]=4,b.items[2]=1,b.count=3,a.capCenter=4):(m=a.vectors.items[0],m.vector[0]=g[0],m.vector[1]=g[1],m.texCoords[0]=k,m.texCoords[1]=n,m=a.vectors.items[1],m.vector[0]=u[0],m.vector[1]=u[1],m.texCoords[0]=k,m.texCoords[1]=n,m=a.vectors.items[2],v(m.vector,y,1/D),m.texCoords[0]=k,m.texCoords[1]=f,c=a.vectors.items[3],c.vector[0]=0,c.vector[1]=0,c.texCoords[0]=k,c.texCoords[1]=
k,a.vectors.count=4,b=a.lists[l.ENTRY],b.items[0]=2,b.items[1]=3,b.items[2]=0,b.count=3,b=a.lists[l.EXIT],b.items[0]=2,b.items[1]=3,b.items[2]=1,b.count=3,a.capCenter=3);R(q,g,u,d,0>h);d=a.vectors.count;g=a.lists[l.CAP];for(u=g.items[0]=0;u<q.count;++u)b=q.items[u],f=a.vectors.items[d+u],f.vector[0]=b[0],f.vector[1]=b[1],f.texCoords[0]=k,f.texCoords[1]=n,g.items[u+1]=d+u;g.items[q.count+1]=1;g.count=q.count+2;a.vectors.count=d+q.count;0>h&&(E(a.lists[l.ENTRY]),E(a.lists[l.EXIT]))};h.unitRoundJoin=
function(a,c,b,d){var h=H(c,b),n=0<h?[B,C]:[C,B],f=n[0],n=n[1];c=0<h?r(e[0],w(e[1],c)):w(e[2],c);b=0<h?r(e[3],w(e[4],b)):w(e[5],b);var g=a.vectors.items[0];g.vector[0]=c[0];g.vector[1]=c[1];g.texCoords[0]=k;g.texCoords[1]=n;g=a.vectors.items[1];g.vector[0]=b[0];g.vector[1]=b[1];g.texCoords[0]=k;g.texCoords[1]=n;g=a.vectors.items[2];r(g.vector,c);g.texCoords[0]=k;g.texCoords[1]=f;g=a.vectors.items[3];r(g.vector,b);g.texCoords[0]=k;g.texCoords[1]=f;f=a.vectors.items[4];f.vector[0]=0;f.vector[1]=0;f.texCoords[0]=
k;f.texCoords[1]=k;a.vectors.count=5;f=a.lists[l.ENTRY];f.items[0]=2;f.items[1]=0;f.count=2;f=a.lists[l.EXIT];f.items[0]=3;f.items[1]=1;f.count=2;a.capCenter=4;R(q,c,b,d,0>h);d=a.vectors.count;c=a.lists[l.CAP];for(f=c.items[0]=0;f<q.count;++f)b=q.items[f],g=a.vectors.items[d+f],g.vector[0]=b[0],g.vector[1]=b[1],g.texCoords[0]=k,g.texCoords[1]=n,c.items[f+1]=d+f;c.items[q.count+1]=1;c.count=q.count+2;a.vectors.count=d+q.count;0>h&&(E(a.lists[l.ENTRY]),E(a.lists[l.EXIT]))};h.rectJoin=function(a,c,b){c=
w(e[0],c);b=w(e[1],b);var d=a.vectors.items[0];d.vector[0]=c[0];d.vector[1]=c[1];d.texCoords[0]=k;d.texCoords[1]=B;d=a.vectors.items[1];d.vector[0]=b[0];d.vector[1]=b[1];d.texCoords[0]=k;d.texCoords[1]=B;d=a.vectors.items[2];r(d.vector,c);d.texCoords[0]=k;d.texCoords[1]=C;c=a.vectors.items[3];r(c.vector,b);c.texCoords[0]=k;c.texCoords[1]=C;a.vectors.count=4;c=a.lists[l.ENTRY];c.items[0]=0;c.items[1]=2;c.count=2;c=a.lists[l.EXIT];c.items[0]=1;c.items[1]=3;c.count=2;a.capCenter=void 0}});