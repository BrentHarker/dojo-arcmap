//>>built
define("require exports dojox/gfx/_base ../SimpleMarkerSymbol ../../core/promiseUtils ../../core/Error ../../core/screenUtils ./renderUtils ./previewUtils ./gfxUtils".split(" "),function(y,p,u,m,r,v,n,w,x,t){Object.defineProperty(p,"__esModule",{value:!0});p.previewSymbol2D=function(d,h){var f=h&&h.size?n.pt2px(h.size):null,k=h&&h.maxSize?n.pt2px(h.maxSize):null,c=t.getStroke(d),g={shape:null,fill:t.getFill(d),stroke:c};c&&c.width&&(c.width=Math.min(c.width,80));var a=0,b=0,q=c&&c.width||0,p=!1,l=
null;switch(d.type){case "simple-marker-symbol":a=m.defaultProps;c=d.style;f=Math.min(f||n.pt2px(d.size||a.size),k||120);switch(a=f,b=f,c){case m.STYLE_CIRCLE:g.shape={type:"circle",cx:0,cy:0,r:.5*f};break;case m.STYLE_CROSS:g.shape={type:"path",path:[{command:"M",values:[0,.5*b]},{command:"L",values:[a,.5*b]},{command:"M",values:[.5*a,0]},{command:"L",values:[.5*a,b]},{command:"E",values:[]}]};break;case m.STYLE_DIAMOND:g.shape={type:"path",path:[{command:"M",values:[0,.5*b]},{command:"L",values:[.5*
a,0]},{command:"L",values:[a,.5*b]},{command:"L",values:[.5*a,b]},{command:"Z",values:[]}]};break;case m.STYLE_SQUARE:g.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[a,0]},{command:"L",values:[a,b]},{command:"L",values:[0,b]},{command:"Z",values:[]}]};break;case m.STYLE_X:g.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[a,b]},{command:"M",values:[a,0]},{command:"L",values:[0,b]},{command:"E",values:[]}]};break;case m.STYLE_PATH:p=!0,g.shape={type:"path",
path:d.path||""}}break;case "simple-line-symbol":d=Math.min(f||q,k||80);a=22<d?2*d:40;b=d;c.width=d;q=0;g.shape={type:"path",path:[{command:"M",values:[0,.5*b]},{command:"L",values:[a,.5*b]},{command:"E",values:[]}]};break;case "picture-fill-symbol":case "simple-fill-symbol":g.shape=x.shapes.fill[0];break;case "picture-marker-symbol":var l=k||120,c=n.pt2px(d.width),e=n.pt2px(d.height),l=Math.min(f||Math.max(c,e),l),a=c/e,c=1>=a?Math.ceil(l*a):l,e=1>=a?l:Math.ceil(l/a),a=c,b=e,l=h.opacity;g.shape=
{type:"image",x:-Math.round(c/2),y:-Math.round(e/2),width:c,height:e,src:d.url||""};break;case "text-symbol":c=d.text||"Aa";e=d.font;f=Math.min(f||n.pt2px(e.size),k||120);for(b=a=0;b<c.length;b++)k=c.charAt(b),k=k===k.toUpperCase()?.7:.5,a+=f*k;b=f;g.shape={type:"text",text:c,x:0,y:.25*u.normalizedLength((e?f:0).toString()),align:"middle",decoration:d.decoration||e&&e.decoration,rotated:d.rotated,kerning:d.kerning};g.font=e&&{size:f,style:e.style,variant:e.variant,decoration:e.decoration,weight:e.weight,
family:e.family}}return g.shape?(a=(a||22)+2*q,b=(b||22)+2*q,r.resolve(w.renderSymbol([[g]],[a,b],{node:h&&h.node,scale:p,opacity:l}))):r.reject(new v("symbolPreview: renderPreviewHTML2D","symbol not supported."))}});