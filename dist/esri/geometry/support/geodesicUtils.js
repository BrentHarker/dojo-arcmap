//>>built
define(["dojo/_base/array","../SpatialReference","../Point","../Polyline","../Polygon"],function(p,H,u,C,F){function z(a){var h=Math.PI/180,b=Math.sin(a.y*h);return new u(6378137*a.x*h,3167719.6636462314*(b/(1-.006694379990197414*b*b)-6.111035746609262*Math.log((1-.0818191908429643*b)/(1+.0818191908429643*b))))}function B(a,h,b,f){var e,m,c,n,d=1/298.257223563,t=Math.sin(b);b=Math.cos(b);var l=(1-d)*Math.tan(a);a=1/Math.sqrt(1+l*l);for(var y=l*a,r=Math.atan2(l,b),l=a*t*a*t,k=1-l,g=2.7233160610754688E11*
k/4.040829998466145E13,A=1+g/16384*(4096+g*(-768+g*(320-175*g))),q=g/1024*(256+g*(-128+g*(74-47*g))),g=f/(6356752.31424518*A),v=2*Math.PI;1E-12<Math.abs(g-v);)c=Math.cos(2*r+g),e=Math.sin(g),m=Math.cos(g),n=q*e*(c+q/4*(m*(-1+2*c*c)-q/6*c*(-3+4*e*e)*(-3+4*c*c))),v=g,g=f/(6356752.31424518*A)+n;f=y*e-a*m*b;k=d/16*k*(4+d*(4-3*k));return new u((h+(Math.atan2(e*t,a*m-y*e*b)-(1-k)*d*Math.sqrt(l)*(g+k*e*(c+k*m*(-1+2*c*c)))))/(Math.PI/180),Math.atan2(y*m+a*e*b,(1-d)*Math.sqrt(l+f*f))/(Math.PI/180),new H({wkid:4326}))}
function D(a,h,b,f){var e,m,c,n,d,t,l,y,r,k,g=1/298.257223563,A=f-h,q=Math.atan((1-g)*Math.tan(a));n=Math.atan((1-g)*Math.tan(b));var v=Math.sin(q),q=Math.cos(q),p=Math.sin(n),w=Math.cos(n),x=A,u=1E3;do{if(l=Math.sin(x),y=Math.cos(x),c=Math.sqrt(w*l*w*l+(q*p-v*w*y)*(q*p-v*w*y)),0===c)return 0;d=v*p+q*w*y;t=Math.atan2(c,d);r=q*w*l/c;m=1-r*r;n=d-2*v*p/m;isNaN(n)&&(n=0);k=g/16*m*(4+g*(4-3*m));e=x;x=A+(1-k)*g*r*(t+k*c*(n+k*d*(-1+2*n*n)))}while(1E-12<Math.abs(x-e)&&0<--u);if(0===u)return c=f-h,{azimuth:Math.atan2(Math.sin(c)*
Math.cos(b),Math.cos(a)*Math.sin(b)-Math.sin(a)*Math.cos(b)*Math.cos(c)),geodesicDistance:6371009*Math.acos(Math.sin(a)*Math.sin(b)+Math.cos(a)*Math.cos(b)*Math.cos(f-h))};a=2.7233160610754688E11*m/4.040829998466145E13;h=a/1024*(256+a*(-128+a*(74-47*a)));return{azimuth:Math.atan2(w*Math.sin(x),q*p-v*w*Math.cos(x)),geodesicDistance:6356752.31424518*(1+a/16384*(4096+a*(-768+a*(320-175*a))))*(t-h*c*(n+h/4*(d*(-1+2*n*n)-h/6*n*(-3+4*c*c)*(-3+4*n*n)))),reverseAzimuth:Math.atan2(q*Math.sin(x),q*p*Math.cos(x)-
v*w)}}function G(a,h){var b=Math.PI/180;if(637.100877151506>h&&(h=637.100877151506),!(a instanceof C||a instanceof F))throw console.error("_geodesicDensify: the input geometry is neither polyline nor polygon"),Error("_geodesicDensify: the input geometry is neither polyline nor polygon");var f,e=a instanceof C,m=[];return p.forEach(e?a.paths:a.rings,function(c){m.push(f=[]);f.push([c[0][0],c[0][1]]);var a,d,t,l,e,r;a=c[0][0]*b;d=c[0][1]*b;for(e=0;e<c.length-1;e++)if(t=c[e+1][0]*b,l=c[e+1][1]*b,a!==
t||d!==l){var k=D(d,a,l,t),g=k.azimuth,k=k.geodesicDistance,p=k/h;if(1<p){for(r=1;p-1>=r;r++){var q=B(d,a,g,r*h);f.push([q.x,q.y])}r=B(d,a,g,(k+Math.floor(p-1)*h)/2);f.push([r.x,r.y])}d=B(d,a,g,k);f.push([d.x,d.y]);a=d.x*b;d=d.y*b}}),e?new C({paths:m,spatialReference:a.spatialReference}):new F({rings:m,spatialReference:a.spatialReference})}var E={esriMiles:1,esriKilometers:1.609344,esriFeet:5280,esriMeters:1609.34,esriYards:1760,esriNauticalMiles:.869,esriCentimeters:160934,esriDecimeters:16093.4,
esriInches:63360,esriMillimeters:1609340,esriAcres:1,esriAres:40.4685642,esriSquareKilometers:.00404685642,esriSquareMiles:.0015625,esriSquareFeet:43560,esriSquareMeters:4046.85642,esriHectares:.404685642,esriSquareYards:4840,esriSquareInches:6272640,esriSquareMillimeters:4046856420,esriSquareCentimeters:4.04685642E7,esriSquareDecimeters:404685.642};return{geodesicDensify:G,geodesicLengths:function(a,h){var b=Math.PI/180,f=[];return p.forEach(a,function(a,m){var c=0;p.forEach(a.paths,function(a,d){var e,
l,f,h,k,g=0;for(d=1;d<a.length;d++)e=a[d-1][0]*b,l=a[d][0]*b,f=a[d-1][1]*b,h=a[d][1]*b,(f!==h||e!==l)&&(k=D(f,e,h,l),g+=k.geodesicDistance/1609.344);c+=g});c*=E[h];f.push(c)}),f},geodesicAreas:function(a,h){var b=[];p.forEach(a,function(a,e){a=G(a,1E4);b.push(a)});var f,e,m=[];return p.forEach(b,function(a,b){var d=0;p.forEach(a.rings,function(a,b){f=z(new u(a[0][0],a[0][1]));e=z(new u(a[a.length-1][0],a[a.length-1][1]));var c=e.x*f.y-f.x*e.y;for(b=0;b<a.length-1;b++)f=z(new u(a[b+1][0],a[b+1][1])),
e=z(new u(a[b][0],a[b][1])),c+=e.x*f.y-f.x*e.y;d+=c/4046.87});d*=E[h];m.push(d/-2)}),m},_unitsDictionary:E,_toEqualAreaPoint:z,_directGeodeticSolver:B,_inverseGeodeticSolver:D}});